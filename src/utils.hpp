#ifndef utils_hpp
#define utils_hpp

#include <cassert>
#include <iomanip>
#include <iostream>
#include <numeric>
#include <vector>

template <typename T>
concept DecimalType = std::is_floating_point_v<T>;

template <DecimalType T> using Vec2d = std::vector<std::vector<T>>;

template <typename T> static void printVec(std::vector<T> &inp) {
    std::cout << std::setprecision(10);
    for (auto val : inp) {
        std::cout << val << ", ";
    }
    std::cout << std::endl << std::endl;
}

template <typename T> static void printVec(Vec2d<T> &inp) {
    std::cout << std::setprecision(10);
    for (auto row : inp) {
        for (auto val : row) {
            std::cout << val << ", ";
        }
        std::cout << std::endl;
    }
    std::cout << std::endl << std::endl;
}

template <typename T> static void printVec(const Vec2d<T> &inp) {
    std::cout << std::setprecision(10);
    for (auto row : inp) {
        for (auto val : row) {
            std::cout << val << ", ";
        }
        std::cout << std::endl;
    }
    std::cout << std::endl << std::endl;
}

template <typename T> Vec2d<T> operator*(const T num, const Vec2d<T> &mat);

template <typename T> Vec2d<T> operator*(const Vec2d<T> &mat, const T num);

template <typename T> Vec2d<T> operator*(const Vec2d<T> &a, const Vec2d<T> &b);

template <typename T> Vec2d<T> operator/(const Vec2d<T> &mat, const T num);

template <typename T> Vec2d<T> operator/(const Vec2d<T> &a, const Vec2d<T> &b);

template <typename T> Vec2d<T> operator-(const Vec2d<T> &mat, const T num);

template <typename T> Vec2d<T> operator-(const Vec2d<T> &a, const Vec2d<T> &b);

template <typename T> Vec2d<T> operator+(const Vec2d<T> &mat, const T num);

template <typename T> Vec2d<T> operator+(const Vec2d<T> &a, const Vec2d<T> &b);

template <typename T> Vec2d<T> power(const Vec2d<T> &mat, const T exponent);

template <typename T> Vec2d<T> root(const Vec2d<T> &mat);

template <typename T> Vec2d<T> transpose(const Vec2d<T> &mat);

template <typename T>
T calculateAccuracy(const Vec2d<T> &output, const Vec2d<T> &actualY);

static Vec2d<double> spiralDataY = {
    {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
      2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
      2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
      2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
      2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2}}};

static Vec2d<double> spiralDataX = {{{0., 0.},
                                     {0.00316407, 0.00959266},
                                     {-0.01694864, 0.01099388},
                                     {-0.01310498, 0.02732276},
                                     {0.02004421, 0.03508156},
                                     {0.05032386, 0.00427422},
                                     {0.05948931, 0.01158086},
                                     {0.03860869, 0.05923562},
                                     {0.06778192, 0.04399496},
                                     {0.08189274, 0.03947203},
                                     {0.10087927, 0.00513931},
                                     {0.11079022, -0.0084384},
                                     {0.08958008, 0.08165653},
                                     {0.12809149, 0.02890862},
                                     {0.13135887, -0.05237182},
                                     {0.10216596, 0.11188815},
                                     {0.15204697, -0.05478597},
                                     {0.13806907, -0.10209661},
                                     {0.1430112, -0.11227487},
                                     {0.17367736, -0.08166486},
                                     {0.18009839, 0.0915245},
                                     {0.16939065, -0.12768013},
                                     {0.17497754, -0.13698751},
                                     {0.20505554, -0.10920765},
                                     {0.22787831, -0.08271028},
                                     {0.19641944, -0.15870856},
                                     {0.14195516, -0.2209554},
                                     {0.06951561, -0.26371907},
                                     {0.20442147, -0.19545767},
                                     {0.03226697, -0.29114672},
                                     {0.17410722, -0.24802024},
                                     {0.12539185, -0.28692874},
                                     {0.00983736, -0.32308259},
                                     {-0.07793511, -0.32409448},
                                     {0.14109606, -0.31311188},
                                     {-0.31256048, -0.16520652},
                                     {-0.27357661, -0.23955634},
                                     {-0.31912647, -0.19451971},
                                     {-0.33741046, -0.18299204},
                                     {0.03542256, -0.39234358},
                                     {-0.32667294, -0.23776762},
                                     {-0.3475441, -0.2252248},
                                     {-0.42414537, 0.0090742},
                                     {-0.43043251, -0.05815561},
                                     {-0.31847167, -0.31001075},
                                     {-0.40153071, -0.21303675},
                                     {-0.35852886, 0.29555607},
                                     {-0.42533931, 0.21088299},
                                     {-0.464001, -0.14064538},
                                     {-0.24220593, 0.43163791},
                                     {-0.50451362, -0.02328128},
                                     {-0.440027, 0.26787557},
                                     {-0.4540975, 0.26398044},
                                     {-0.23019345, 0.48333672},
                                     {-0.5437318, -0.04331736},
                                     {-0.14696146, 0.53576516},
                                     {0.1328078, 0.54984492},
                                     {-0.14907894, 0.55612252},
                                     {-0.19634385, 0.5519777},
                                     {-0.58263596, 0.12531232},
                                     {0.39628256, 0.45855162},
                                     {-0.0241689, 0.61568742},
                                     {0.26131886, 0.56913736},
                                     {0.13741821, 0.62134927},
                                     {-0.13476525, 0.63226171},
                                     {0.01130822, 0.65646827},
                                     {-0.02022879, 0.66635969},
                                     {0.39810732, 0.54728882},
                                     {0.12184789, 0.67597462},
                                     {0.59997308, 0.35468164},
                                     {0.39232556, 0.58824284},
                                     {0.53174946, 0.4812253},
                                     {0.36280549, 0.63031563},
                                     {0.71710491, 0.17169909},
                                     {0.46356594, 0.58636603},
                                     {0.69298513, 0.30609254},
                                     {0.7582014, 0.12024248},
                                     {0.74996793, -0.20612224},
                                     {0.78687372, 0.0397835},
                                     {0.64254532, -0.4731884},
                                     {0.73806057, -0.32903069},
                                     {0.81421771, -0.08044253},
                                     {0.67948512, -0.47365854},
                                     {0.09248206, -0.83326738},
                                     {0.66334325, -0.52905791},
                                     {0.29856989, -0.80500043},
                                     {0.72013416, -0.48582266},
                                     {-0.12146783, -0.87035263},
                                     {0.57634193, -0.67672257},
                                     {-0.01909316, -0.89878712},
                                     {0.01526886, -0.90896267},
                                     {-0.09386729, -0.91438652},
                                     {0.77199916, -0.51730325},
                                     {-0.3765065, -0.86064152},
                                     {0.17853609, -0.93255859},
                                     {0.21552685, -0.93507892},
                                     {-0.45243522, -0.85767977},
                                     {0.72713561, -0.65671751},
                                     {-0.64284378, -0.75276283},
                                     {-0.3119236, -0.95010719},
                                     {0., -0.},
                                     {-0.00771918, -0.00651495},
                                     {-0.01356016, -0.01497477},
                                     {-0.02881029, -0.00939367},
                                     {-0.01799603, -0.03617498},
                                     {-0.02432606, -0.04426062},
                                     {-0.0032125, -0.06052086},
                                     {-0.06771115, -0.02036393},
                                     {-0.03051407, -0.07482538},
                                     {-0.07580447, 0.05018112},
                                     {-0.09869865, 0.02148527},
                                     {-0.11036504, 0.01285445},
                                     {-0.10494299, 0.06065762},
                                     {-0.09210631, 0.09359255},
                                     {-0.10473335, 0.09502045},
                                     {-0.14249283, 0.05150373},
                                     {-0.1583418, 0.03236753},
                                     {-0.1100531, 0.13181465},
                                     {0.02976622, 0.17936506},
                                     {0.01041308, 0.19163649},
                                     {-0.20180465, -0.00932988},
                                     {-0.03299117, 0.20953995},
                                     {0.12578397, 0.18319691},
                                     {0.00783042, 0.23219123},
                                     {-0.07009595, 0.23206911},
                                     {-0.08665708, 0.23719096},
                                     {-0.2198371, 0.14368091},
                                     {0.06592759, 0.26463885},
                                     {0.19464812, 0.20519246},
                                     {-0.09834358, 0.27592773},
                                     {-0.08800706, 0.28996917},
                                     {0.26637029, 0.16461496},
                                     {0.28251805, 0.15704358},
                                     {0.33314882, 0.01108939},
                                     {0.00054116, 0.34343392},
                                     {0.0468039, 0.35042352},
                                     {0.33347612, 0.14500028},
                                     {0.3514193, 0.12721676},
                                     {0.24716659, 0.29366747},
                                     {0.17097064, 0.35490462},
                                     {0.06567308, 0.3986674},
                                     {0.33016601, 0.25000703},
                                     {0.32041533, 0.27805692},
                                     {0.43242726, -0.04075392},
                                     {0.42173054, -0.14026481},
                                     {0.44753784, -0.07950758},
                                     {0.46419206, -0.02054434},
                                     {0.34585209, -0.3252253},
                                     {0.4086912, -0.2608631},
                                     {0.40150948, -0.28942207},
                                     {0.18116233, -0.47144058},
                                     {0.03937074, -0.51364485},
                                     {0.36591978, -0.37681949},
                                     {0.12599226, -0.52031659},
                                     {0.32190714, -0.44033675},
                                     {-0.45727273, -0.31550535},
                                     {0.30614965, -0.47564666},
                                     {-0.31774592, -0.48013989},
                                     {0.02188773, -0.58544958},
                                     {0.18358772, -0.56697742},
                                     {-0.45501058, -0.40034339},
                                     {-0.25602022, -0.56045409},
                                     {0.01160808, -0.62615504},
                                     {-0.63399494, -0.05485526},
                                     {0.23813675, -0.60100535},
                                     {-0.20119561, -0.62497903},
                                     {-0.57679546, -0.33429245},
                                     {-0.60451474, -0.30426373},
                                     {-0.65667911, -0.20139797},
                                     {-0.69686105, -0.0123059},
                                     {-0.38946603, -0.59013998},
                                     {-0.68048472, -0.22644165},
                                     {-0.70458426, 0.18024051},
                                     {-0.73722245, 0.01493617},
                                     {-0.74667028, -0.03466975},
                                     {-0.75754301, 0.00704365},
                                     {-0.7554026, 0.13672794},
                                     {-0.77555527, 0.05875628},
                                     {-0.17543145, 0.76809947},
                                     {-0.59059449, 0.53662827},
                                     {-0.78294297, 0.19998726},
                                     {-0.3483379, 0.74032574},
                                     {-0.76644106, 0.31403907},
                                     {0.0967348, 0.83278439},
                                     {-0.2074055, 0.8227451},
                                     {0.55106282, 0.65840675},
                                     {-0.41111798, 0.76524433},
                                     {-0.35333178, 0.80462711},
                                     {-0.15640252, 0.87502098},
                                     {-0.56779888, 0.69698441},
                                     {0.87053288, 0.26195189},
                                     {-0.05319143, 0.9176516},
                                     {0.43641982, 0.82044079},
                                     {0.54995662, 0.76158302},
                                     {0.72881595, 0.60857865},
                                     {0.78166114, 0.55662399},
                                     {0.21365088, 0.9458676},
                                     {0.68767628, 0.69792937},
                                     {0.95102669, -0.27467845},
                                     {0.79501756, 0.60658641},
                                     {0., 0.},
                                     {0.00647389, 0.00775365},
                                     {0.01629702, 0.01193854},
                                     {0.01883737, 0.02373662},
                                     {0.04036277, -0.00182573},
                                     {0.05035914, 0.00383636},
                                     {0.05513614, -0.02516148},
                                     {0.07054694, -0.00475592},
                                     {0.02319578, -0.07740738},
                                     {0.0903848, -0.00974938},
                                     {0.09603382, -0.03131368},
                                     {0.1110736, 0.00288686},
                                     {0.12087222, -0.00907115},
                                     {0.04695456, -0.12263118},
                                     {0.01937745, -0.14008024},
                                     {-0.02546917, -0.14935917},
                                     {0.08358807, -0.13832143},
                                     {-0.00077179, -0.17171544},
                                     {-0.02025788, -0.18068611},
                                     {0.07676253, -0.17589909},
                                     {-0.10756706, -0.17100143},
                                     {-0.11723284, -0.17678199},
                                     {0.16190728, -0.15221284},
                                     {-0.12894952, -0.19325141},
                                     {-0.11052961, -0.21576079},
                                     {0.04907141, -0.24771152},
                                     {-0.10522333, -0.24062544},
                                     {0.05283108, -0.26756129},
                                     {-0.17093359, -0.22532986},
                                     {-0.00880887, -0.29279681},
                                     {-0.19479269, -0.23212749},
                                     {-0.28709881, -0.12500196},
                                     {-0.28967742, -0.14340896},
                                     {-0.26411408, 0.20335895},
                                     {-0.3434278, 0.00211972},
                                     {-0.33448133, -0.11449668},
                                     {-0.35553448, -0.07633241},
                                     {-0.36178548, 0.09375975},
                                     {-0.37828863, 0.06503552},
                                     {-0.36242405, 0.15439253},
                                     {-0.35215602, 0.19807773},
                                     {-0.39244459, 0.1322889},
                                     {-0.29603351, 0.30388451},
                                     {0.19974382, 0.3856898},
                                     {-0.42360566, 0.13449576},
                                     {-0.27582755, 0.36129037},
                                     {-0.27840997, 0.3720003},
                                     {-0.45395748, 0.1389524},
                                     {-0.03844278, 0.48332205},
                                     {-0.22364537, 0.4415402},
                                     {0.15245601, 0.48149058},
                                     {0.14950345, 0.49298053},
                                     {0.34197496, 0.39867699},
                                     {0.01199303, 0.53521918},
                                     {0.09738179, 0.5366912},
                                     {0.24117072, 0.50047843},
                                     {0.53492629, 0.18390545},
                                     {0.23854825, 0.52401481},
                                     {0.49582428, 0.31207141},
                                     {0.47273234, 0.36289389},
                                     {0.54516255, 0.26477774},
                                     {0.21583078, 0.57712409},
                                     {0.56148388, 0.27738192},
                                     {0.33464193, 0.54127022},
                                     {0.62627675, 0.16029338},
                                     {0.60234282, 0.26126919},
                                     {0.5687354, -0.34782825},
                                     {0.66884889, 0.10322621},
                                     {0.6164973, 0.30285255},
                                     {0.68389849, -0.13434886},
                                     {0.33691185, -0.62164249},
                                     {0.47117085, -0.54067856},
                                     {0.66286043, -0.29923515},
                                     {0.73490641, 0.06027109},
                                     {0.73122802, -0.15499702},
                                     {0.4272783, -0.62558315},
                                     {0.75790252, -0.12211217},
                                     {0.32242545, -0.70779948},
                                     {0.47094192, -0.6316381},
                                     {0.1031368, -0.79128665},
                                     {0.67603067, -0.44269304},
                                     {-0.35653788, -0.73641173},
                                     {0.23756723, -0.79348236},
                                     {0.18331283, -0.81809771},
                                     {-0.6000752, -0.59986356},
                                     {0.43027715, -0.74298806},
                                     {-0.66738036, -0.55607584},
                                     {-0.10668825, -0.87228766},
                                     {-0.73003101, -0.50712737},
                                     {-0.89651869, 0.06661133},
                                     {-0.59525919, -0.68710464},
                                     {-0.82108442, -0.4131999},
                                     {-0.1203501, -0.92146688},
                                     {-0.93192641, 0.11821229},
                                     {-0.52793683, -0.78919159},
                                     {-0.95192182, -0.12111671},
                                     {-0.54834723, -0.79976717},
                                     {-0.92579532, -0.32079137},
                                     {-0.84354205, 0.51801237},
                                     {-0.99472625, 0.10256551}}};

#endif
