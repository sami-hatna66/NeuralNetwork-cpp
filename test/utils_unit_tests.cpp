#include <gtest/gtest.h>
#include "test_helpers.hpp"
#include "utils.hpp"

typedef ::testing::Types<float, double> TestTypes;

template <typename T>
class UtilsTest : public ::testing::Test {};

TYPED_TEST_SUITE(UtilsTest, TestTypes);

TYPED_TEST(UtilsTest, UtilsTestMatMulSmall) {
    Vec2d<TypeParam> a {{4, 9}, {3, 4}};
    Vec2d<TypeParam> b {{4, 9, 5}, {3, 4, 6}};

    auto result = a * b;

    Vec2d<TypeParam> expected {{43, 72, 74}, {24, 43, 39}};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestMatMulMed) {
    Vec2d<TypeParam> a {{9, 3, 0, 2, 4,},
                        {3, 0, 0, 3, 2,},
                        {1, 2, 5, 8, 5,},
                        {8, 3, 5, 3, 1,},
                        {1, 0, 3, 2, 8,},
                        {6, 1, 3, 3, 1,},
                        {0, 0, 9, 7, 2,},
                        {9, 6, 1, 4, 0,},
                        {4, 7, 5, 8, 6,},
                        {6, 1, 9, 4, 0,},
                        {8, 1, 9, 7, 5,},
                        {6, 5, 5, 2, 4,},
                        {9, 2, 4, 1, 0,},
                        {3, 5, 9, 5, 0,},
                        {1, 5, 3, 7, 4,},};

    Vec2d<TypeParam> b {{5, 4, 0, 4, 6, 5, 1, 1, 1, 5, 4, 6, 0, 5, 0, 1, 8, 6, 9, 8,},
                        {9, 4, 5, 9, 4, 0, 0, 7, 2, 8, 3, 4, 2, 0, 8, 7, 6, 8, 4, 5,},
                        {1, 2, 8, 0, 7, 4, 4, 4, 1, 9, 6, 5, 2, 6, 2, 4, 8, 6, 3, 3,},
                        {4, 8, 2, 5, 9, 8, 1, 9, 7, 1, 6, 1, 1, 6, 2, 7, 2, 8, 2, 1,},
                        {2, 3, 3, 7, 1, 4, 6, 4, 8, 2, 9, 4, 9, 1, 2, 8, 0, 1, 4, 8,},
                        {8, 0, 8, 0, 0, 0, 6, 6, 5, 7, 0, 0, 4, 7, 2, 0, 4, 0, 7, 0,},
                        {1, 1, 8, 0, 3, 7, 0, 9, 8, 1, 9, 6, 6, 2, 5, 9, 5, 5, 6, 9,},
                        {8, 8, 2, 0, 6, 9, 6, 6, 4, 1, 1, 5, 3, 2, 0, 9, 2, 2, 2, 0,},
                        {4, 9, 0, 6, 2, 1, 7, 0, 8, 0, 9, 3, 4, 4, 7, 0, 5, 5, 7, 2,},
                        {8, 0, 3, 4, 5, 5, 0, 5, 1, 8, 8, 1, 1, 0, 1, 7, 8, 2, 3, 8,},
                        {4, 0, 5, 8, 2, 8, 5, 8, 9, 6, 9, 3, 6, 8, 7, 7, 6, 8, 1, 5,},
                        {9, 2, 0, 4, 4, 9, 1, 3, 1, 3, 6, 1, 6, 6, 1, 3, 2, 7, 8, 9,},
                        {6, 9, 4, 0, 2, 9, 3, 6, 9, 3, 5, 7, 2, 0, 1, 9, 7, 6, 6, 1,},
                        {6, 3, 6, 1, 0, 4, 9, 2, 6, 9, 8, 7, 6, 3, 1, 3, 1, 7, 1, 5,},
                        {9, 8, 5, 6, 2, 9, 5, 2, 9, 3, 5, 4, 2, 2, 3, 0, 1, 8, 5, 6,},
                        {3, 8, 1, 3, 5, 8, 3, 2, 5, 0, 9, 2, 1, 5, 5, 9, 9, 9, 2, 8,},
                        {1, 5, 8, 5, 1, 6, 2, 6, 8, 3, 9, 7, 0, 4, 0, 4, 4, 8, 8, 3,},
                        {5, 0, 3, 4, 1, 6, 8, 1, 7, 8, 1, 1, 3, 3, 4, 1, 2, 6, 8, 3,},
                        {8, 5, 8, 0, 7, 7, 6, 9, 5, 5, 8, 4, 2, 1, 1, 2, 5, 8, 4, 3,},
                        {7, 1, 3, 0, 0, 0, 0, 3, 5, 7, 7, 7, 3, 8, 9, 0, 5, 4, 4, 4,},};

    auto result = a * b;

    Vec2d<TypeParam> expected {{88,  76,  31, 101,  88,  77, 35,  64,  61,  79,  93,  84, 44,  61, 36,  76,  94,  98, 113, 121,},
                               {31,  42,  12,  41,  47,  47, 18,  38,  40,  22,  48,  29, 21,  35, 10,  40,  30,  44,  41,  43,},
                               {70, 101,  81,  97, 126, 109, 59, 127, 106,  84, 133,  67, 67,  88, 52, 131,  76, 121,  68,  81,},
                               {86,  81,  64,  81, 123,  88, 37,  80,  48, 114,  98,  92, 28,  89, 42,  78, 128, 127, 109, 105,},
                               {32,  50,  52,  70,  53,  65, 63,  63,  82,  50, 106,  55, 80,  43, 26,  91,  36,  48,  54,  83,},
                               {56,  61,  38,  55,  89,  70, 27,  56,  40,  70,  72,  62, 20,  67, 22,  54,  84,  87,  77,  73,},
                               {41,  80,  92,  49, 128, 100, 55, 107,  74,  92, 114,  60, 43,  98, 36, 101,  86, 112,  49,  50,},
                               {116,  94,  46, 110, 121,  81, 17,  91,  50, 106,  84,  87, 18,  75, 58,  83, 124, 140, 116, 109,},
                               {132, 136, 109, 161, 165, 128, 68, 169, 127, 141, 169, 109, 86, 104, 94, 177, 130, 180, 119, 138,},
                               {64,  78,  85,  53, 139,  98, 46,  85,  45, 123, 105,  89, 24, 108, 34,  77, 134, 130,  93,  84,},
                               {96, 125, 106, 111, 183, 152, 81, 134, 108, 146, 176, 124, 72, 141, 50, 140, 156, 171, 137, 143,},
                               {96,  82,  81, 107, 113,  82, 52,  95,  67, 125, 117,  99, 58,  76, 62, 107, 122, 126, 109, 122,},
                               {71,  60,  44,  59,  99,  69, 26,  48,  24,  98,  72,  83, 13,  75, 26,  46, 118, 102, 103,  95,},
                               {89,  90, 107,  82, 146,  91, 44, 119,  57, 141, 111,  88, 33,  99, 68, 109, 136, 152,  84,  81,},
                               {89,  98,  75, 112, 114,  89, 44, 127,  95,  87, 115,  64, 59,  69, 68, 129,  76, 124,  68,  81,},};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestMatMulBig) {
    Vec2d<TypeParam> a {{9, 4, 7, 8, 3, 8, 0, 0, 6, 8, 9, 1, 7, 9, 7, 7, 0, 7, 1, 7},
                        {0, 2, 2, 6, 4, 6, 6, 3, 6, 6, 7, 1, 1, 2, 1, 4, 5, 2, 6, 4},
                        {1, 3, 4, 5, 9, 3, 0, 9, 2, 1, 1, 6, 4, 3, 6, 2, 0, 3, 8, 2},
                        {9, 1, 6, 7, 4, 0, 1, 5, 4, 9, 4, 7, 8, 8, 8, 3, 5, 5, 8, 2},
                        {9, 4, 2, 7, 4, 0, 5, 9, 8, 7, 1, 8, 9, 9, 2, 4, 7, 9, 4, 3},
                        {7, 1, 2, 8, 0, 1, 7, 6, 0, 7, 9, 4, 6, 0, 3, 1, 8, 5, 2, 5},
                        {4, 0, 7, 9, 5, 9, 8, 1, 4, 1, 1, 9, 4, 2, 8, 1, 2, 4, 4, 9},
                        {0, 0, 0, 9, 4, 1, 8, 8, 2, 3, 3, 6, 3, 5, 4, 0, 3, 3, 0, 1},
                        {5, 3, 1, 1, 9, 1, 6, 1, 5, 6, 6, 1, 0, 1, 6, 5, 4, 1, 9, 9},
                        {6, 1, 9, 3, 0, 7, 3, 8, 2, 0, 4, 5, 4, 9, 4, 7, 8, 1, 7, 3},
                        {0, 1, 9, 7, 0, 5, 2, 5, 6, 2, 7, 3, 4, 9, 2, 1, 5, 7, 6, 2},
                        {4, 3, 0, 9, 6, 9, 5, 2, 1, 8, 3, 5, 7, 5, 4, 9, 8, 3, 9, 7},
                        {7, 2, 5, 8, 5, 6, 5, 7, 3, 6, 8, 7, 7, 4, 6, 9, 1, 6, 3, 1},
                        {0, 4, 9, 5, 0, 7, 8, 2, 9, 0, 4, 3, 7, 8, 0, 8, 7, 3, 9, 1},
                        {7, 8, 0, 7, 8, 3, 4, 3, 5, 4, 8, 0, 3, 0, 7, 3, 3, 4, 6, 6},
                        {2, 2, 8, 9, 2, 0, 7, 7, 3, 7, 6, 8, 1, 4, 0, 4, 0, 1, 1, 8},
                        {5, 9, 2, 8, 2, 4, 2, 9, 8, 5, 9, 9, 9, 0, 8, 0, 8, 3, 7, 0},
                        {1, 2, 1, 8, 5, 4, 5, 2, 2, 8, 7, 5, 7, 8, 3, 7, 5, 5, 6, 5},
                        {2, 8, 1, 9, 8, 6, 7, 9, 9, 0, 8, 0, 0, 5, 2, 8, 3, 9, 5, 7},
                        {4, 4, 0, 9, 8, 7, 2, 6, 0, 3, 1, 8, 3, 6, 9, 2, 5, 9, 5, 1},
                        {3, 9, 1, 2, 4, 5, 5, 5, 1, 0, 0, 8, 2, 7, 2, 8, 5, 8, 1, 9},
                        {1, 8, 7, 0, 5, 9, 0, 5, 1, 8, 6, 6, 9, 9, 7, 5, 7, 9, 3, 1},
                        {3, 1, 7, 7, 5, 5, 3, 8, 5, 8, 1, 4, 3, 8, 3, 3, 2, 1, 7, 2},
                        {4, 6, 0, 5, 8, 7, 8, 3, 9, 6, 4, 6, 0, 0, 6, 4, 2, 8, 7, 1},
                        {3, 5, 1, 6, 9, 1, 4, 3, 4, 1, 4, 3, 5, 5, 4, 6, 4, 3, 0, 1},
                        {1, 4, 4, 7, 4, 3, 1, 5, 1, 7, 6, 1, 6, 8, 7, 3, 8, 9, 1, 1},
                        {9, 3, 1, 2, 7, 6, 9, 1, 4, 4, 7, 6, 5, 5, 5, 6, 8, 7, 0, 7},
                        {9, 1, 3, 0, 9, 2, 4, 9, 5, 2, 8, 2, 6, 2, 2, 1, 9, 7, 9, 2},
                        {0, 0, 1, 7, 3, 9, 3, 8, 8, 8, 6, 8, 9, 7, 8, 8, 9, 1, 7, 6},
                        {4, 4, 8, 4, 4, 5, 7, 1, 9, 9, 8, 2, 7, 8, 3, 5, 8, 4, 4, 5},
                        {2, 6, 1, 6, 6, 6, 3, 9, 5, 0, 0, 7, 1, 1, 2, 9, 1, 6, 6, 1},
                        {1, 9, 5, 2, 3, 5, 0, 6, 5, 9, 6, 4, 1, 0, 1, 1, 7, 7, 1, 2},
                        {6, 4, 4, 4, 3, 2, 2, 1, 7, 6, 4, 0, 6, 8, 0, 1, 4, 4, 5, 8},
                        {3, 1, 9, 0, 5, 8, 7, 4, 7, 6, 1, 9, 7, 1, 3, 1, 3, 8, 5, 1},
                        {3, 6, 3, 3, 4, 8, 7, 9, 4, 6, 9, 4, 0, 0, 5, 8, 0, 8, 5, 5},
                        {4, 8, 1, 2, 4, 2, 0, 3, 2, 0, 3, 9, 6, 5, 2, 5, 6, 7, 6, 5},
                        {9, 5, 9, 0, 8, 5, 3, 0, 5, 9, 2, 6, 0, 2, 3, 5, 1, 9, 0, 6},
                        {6, 1, 2, 4, 2, 5, 1, 8, 1, 7, 4, 8, 9, 5, 6, 4, 9, 4, 5, 8},
                        {4, 4, 5, 7, 4, 7, 9, 5, 5, 1, 2, 8, 7, 8, 8, 2, 4, 9, 3, 0},
                        {3, 8, 7, 4, 5, 0, 4, 9, 7, 0, 8, 6, 6, 2, 6, 5, 1, 7, 2, 7},
                        {1, 6, 0, 3, 7, 8, 5, 7, 1, 3, 4, 7, 7, 4, 8, 1, 1, 5, 8, 9},
                        {9, 9, 9, 7, 5, 7, 1, 4, 7, 5, 3, 5, 0, 5, 7, 3, 6, 0, 7, 7},
                        {6, 3, 3, 8, 2, 3, 8, 6, 4, 6, 8, 9, 8, 8, 1, 7, 7, 1, 3, 1},
                        {9, 5, 4, 3, 2, 9, 5, 2, 5, 8, 5, 5, 6, 9, 5, 5, 0, 3, 5, 1},
                        {2, 4, 1, 3, 2, 0, 3, 9, 0, 2, 3, 8, 0, 9, 0, 0, 5, 6, 2, 3},
                        {9, 3, 4, 0, 4, 5, 7, 0, 5, 0, 0, 6, 5, 4, 0, 5, 7, 1, 3, 8},
                        {7, 2, 8, 3, 2, 3, 8, 7, 6, 1, 4, 9, 9, 1, 0, 0, 1, 8, 3, 7},
                        {8, 5, 5, 5, 4, 4, 5, 3, 1, 2, 6, 5, 5, 4, 4, 5, 1, 9, 7, 2},
                        {5, 1, 7, 9, 0, 7, 6, 7, 9, 9, 3, 2, 6, 4, 3, 1, 7, 5, 6, 7},
                        {0, 9, 6, 9, 8, 5, 5, 7, 4, 3, 2, 4, 6, 4, 3, 1, 3, 0, 7, 5},};

    Vec2d<TypeParam> b {{26,2,0,36,17,5,24,37,3,12,25,28,47,26,49,18,43,3,41,39,34,31,32,19,3,25,10,19,10,40,42,12,48,2,11,2,49,10,11,22,28,39,49,32,27,6,42,26,32,32},
                        {36,21,21,19,45,15,44,8,39,31,49,49,46,43,16,39,41,41,7,12,27,20,40,19,25,44,22,13,36,20,42,32,1,13,19,33,4,36,24,30,19,47,14,46,27,41,28,28,1,12},
                        {29,21,11,13,25,4,4,7,50,23,44,11,4,47,38,4,39,13,42,28,11,45,37,32,29,28,20,20,39,12,28,33,25,12,10,37,39,49,21,29,40,4,9,16,21,40,22,39,25,10},
                        {16,20,7,27,44,1,12,13,44,25,6,4,24,45,12,9,30,49,19,12,49,25,27,7,11,9,42,48,4,7,6,5,27,12,14,11,49,11,17,33,15,12,16,2,44,6,11,33,15,30},
                        {42,22,25,35,1,13,3,20,48,35,30,44,30,34,44,37,42,11,12,46,38,40,43,49,11,47,9,7,7,11,39,50,10,20,35,49,31,8,8,17,8,29,15,21,29,44,7,46,0,46},
                        {1,21,37,17,14,46,31,30,40,19,26,2,45,12,34,27,33,12,8,14,4,0,41,37,29,27,24,49,38,6,43,6,7,12,26,26,15,20,10,25,20,20,12,3,45,36,18,28,4,43},
                        {35,5,30,4,16,40,49,22,46,26,0,4,33,12,8,21,37,40,28,37,34,1,35,9,45,16,19,50,36,35,14,31,27,29,7,17,44,19,43,17,44,42,34,31,19,47,40,1,26,43},
                        {14,47,9,35,32,16,0,15,14,25,49,50,16,3,35,46,14,24,46,35,42,11,45,14,12,38,0,11,47,47,43,34,15,34,44,42,13,19,5,50,36,26,26,3,16,23,6,44,29,43},
                        {12,50,25,13,4,15,25,33,2,33,9,12,43,27,41,33,39,45,16,8,33,19,3,28,34,43,22,4,17,18,30,49,33,49,4,23,30,20,23,40,3,26,14,31,36,4,13,2,10,0},
                        {5,14,28,37,22,11,44,15,11,3,41,42,49,40,45,16,17,6,12,40,19,21,18,27,2,35,22,23,25,48,6,14,25,12,48,29,12,5,14,10,16,37,32,3,19,24,36,50,36,32},
                        {37,27,37,42,38,8,49,11,8,21,36,17,45,38,2,39,42,38,12,12,4,31,40,19,4,38,31,37,14,41,10,15,24,14,0,18,26,37,9,35,33,10,14,32,44,5,6,37,14,22},
                        {7,15,33,31,50,33,6,14,45,40,47,4,32,15,36,1,14,36,50,27,46,38,13,32,5,8,26,22,2,49,40,19,27,44,48,5,38,4,35,38,39,18,43,43,10,19,38,31,23,37},
                        {35,27,5,18,8,34,13,3,39,31,16,37,5,10,28,1,19,30,32,48,42,8,7,27,48,28,49,14,10,36,38,31,5,21,14,36,44,3,5,2,8,15,20,39,8,41,2,30,5,35},
                        {31,32,10,35,43,21,32,31,6,37,36,15,44,5,23,33,20,33,30,34,40,22,34,22,3,13,39,13,17,30,21,32,25,40,45,25,31,20,19,19,46,21,11,2,29,41,42,9,7,33},
                        {34,22,31,36,32,1,8,17,49,39,39,27,40,39,48,12,11,7,38,26,21,23,44,2,36,24,37,17,49,24,6,34,14,12,24,32,9,50,30,16,17,12,29,49,16,8,27,46,33,26},
                        {40,38,29,3,38,36,45,37,15,24,17,34,23,5,35,44,12,29,10,21,13,29,22,23,29,5,46,25,13,42,17,16,1,14,24,6,30,7,9,9,48,48,36,28,37,32,4,17,4,16},
                        {44,3,2,32,40,35,30,41,28,46,14,41,3,44,41,13,44,36,29,30,41,40,5,44,44,30,12,22,0,31,13,8,40,8,24,48,4,19,26,46,49,3,29,6,3,34,1,21,22,38},
                        {40,22,41,30,16,25,11,6,12,48,10,26,41,43,21,5,34,33,32,18,25,22,29,33,24,34,18,31,36,43,41,49,6,10,22,37,48,7,24,16,19,45,11,1,11,38,35,4,26,16},
                        {16,49,24,32,28,43,18,31,48,23,47,8,25,36,25,39,27,13,32,0,47,20,39,44,27,19,28,44,31,8,49,9,8,34,42,25,44,9,12,25,10,36,0,39,18,36,31,20,17,35},
                        {11,24,25,44,34,13,43,11,23,8,11,15,16,5,32,44,43,0,42,13,31,23,2,14,16,32,16,39,16,1,23,49,16,25,19,38,35,29,12,22,26,8,14,22,41,37,23,34,31,33}};

    auto result = a * b;

    Vec2d<TypeParam> expected {{2710, 2581, 2359, 2995, 2878, 1826, 2868, 2077, 2634, 2707, 2850, 2386, 3660, 2927, 3311, 2501, 3256, 2502, 2673, 2632, 2792, 2546, 2988, 2492, 2069, 2911, 3027, 2766, 2346, 2871, 2722, 2815, 2081, 1934, 2294, 2682, 3368, 2207, 1691, 2360, 2644, 2591, 2207, 2258, 3141, 2743, 2401, 3039, 1889, 2833,}, 
                               {1751, 1891, 1753, 1946, 1970, 1661, 2140, 1601, 2075, 1882, 1855, 1548, 2315, 2043, 2066, 2022, 2354, 1981, 1655, 1610, 2118, 1621, 2030, 1924, 1647, 2058, 1813, 2201, 1606, 1850, 1816, 1767, 1443, 1591, 1688, 1987, 2124, 1372, 1284, 1961, 1872, 1820, 1411, 1462, 2095, 2032, 1416, 1955, 1262, 2191,}, 
                               {1732, 2082, 1531, 2085, 1948, 1439, 1080, 1304, 2475, 2110, 2412, 1793, 2035, 1885, 2333, 1829, 1926, 1646, 2129, 1820, 2454, 1739, 2333, 1922, 1442, 1990, 1709, 1657, 1778, 1799, 2339, 2053, 1104, 1715, 2134, 2134, 2178, 1315, 1145, 1895, 1622, 1748, 1364, 1695, 1695, 2056, 1439, 2299, 1214, 2285,}, 
                               {2609, 2499, 1954, 3074, 2902, 1911, 2157, 2084, 2863, 2864, 3120, 2510, 3144, 2942, 3428, 2116, 2850, 2427, 3112, 2833, 3410, 2642, 2828, 2603, 2028, 2660, 2717, 2420, 2157, 3108, 2788, 2568, 2237, 2172, 2767, 2696, 3297, 1809, 1796, 2501, 2617, 2469, 2362, 2349, 2311, 2638, 2433, 3039, 2106, 3063,}, 
                               {2828, 2679, 2050, 3058, 3000, 2307, 2457, 2273, 2728, 3230, 2906, 2839, 3351, 2779, 3496, 2409, 3175, 3046, 3259, 3080, 3873, 2581, 2760, 2775, 2296, 2946, 2668, 2485, 2201, 3517, 3205, 3034, 2380, 2537, 2882, 2925, 3547, 1625, 2013, 2828, 2914, 2946, 2610, 2281, 2429, 3032, 2540, 2767, 2107, 3271,}, 
                               {2121, 1594, 1607, 2438, 2388, 1568, 2156, 1500, 2178, 2103, 2020, 1978, 2355, 2321, 2298, 1675, 2539, 2153, 2384, 2198, 2556, 1909, 2117, 1810, 1709, 2186, 1935, 2391, 1639, 2628, 1916, 1834, 1907, 1435, 1756, 2118, 2544, 1468, 1480, 2164, 2308, 1850, 2031, 1687, 1906, 2024, 1703, 2391, 1853, 2591,}, 
                               {2042, 1989, 2115, 2424, 2430, 1929, 1953, 1735, 3250, 2511, 2251, 1469, 2686, 2352, 2861, 1827, 2808, 2126, 2763, 2212, 2841, 2097, 2496, 2186, 2140, 2233, 2314, 2747, 2077, 2058, 2503, 2471, 1841, 1983, 2082, 2349, 3096, 1853, 1864, 2268, 2303, 1940, 1971, 2137, 2412, 2556, 2165, 2549, 1805, 2866,}, 
                               {1556, 1446, 1298, 1764, 1855, 1244, 1305, 1135, 1925, 1894, 1590, 1381, 1876, 1528, 1710, 1343, 1696, 1937, 1846, 1791, 2255, 1338, 1825, 1310, 1267, 1550, 1545, 1690, 1364, 1943, 1485, 1679, 1351, 1534, 1660, 1664, 1952, 1061, 1296, 1742, 1766, 1439, 1485, 1168, 1474, 1648, 1348, 1748, 1244, 2138,}, 
                               {2099, 1966, 1911, 2346, 2029, 1592, 2294, 1787, 2295, 1967, 2164, 1936, 2562, 2214, 2563, 2377, 2603, 1614, 2013, 1885, 2374, 1981, 2229, 2065, 1702, 2334, 1804, 2133, 1721, 1946, 2060, 2227, 1551, 1673, 1895, 2213, 2342, 1579, 1386, 1883, 1919, 2127, 1696, 2115, 2149, 2229, 1758, 2285, 1536, 2404,}, 
                               {2304, 2314, 1662, 2387, 2763, 2107, 2093, 2110, 2582, 2528, 2731, 1950, 2429, 2120, 2876, 2228, 2598, 2201, 2760, 2268, 2733, 2205, 2641, 2342, 2059, 2155, 2286, 2346, 2090, 2511, 2592, 2059, 1880, 1963, 2310, 2372, 2685, 1877, 1552, 2489, 2894, 1987, 1962, 1885, 2208, 2617, 1896, 2410, 1649, 2748,}, 
                               {2061, 2251, 1715, 2244, 2393, 1712, 1838, 1595, 2265, 2435, 2318, 1567, 2391, 2348, 2277, 1842, 2511, 2366, 2327, 1833, 2476, 1969, 2345, 2156, 1811, 2182, 2178, 2225, 1942, 2160, 2238, 2141, 1672, 1887, 1932, 2318, 2619, 1743, 1481, 2306, 2268, 1718, 1363, 1456, 2103, 2303, 1735, 2067, 1456, 2240,}, 
                               {2607, 2487, 2302, 2901, 3018, 2594, 2856, 2354, 3257, 2796, 2736, 2447, 3160, 2688, 3277, 2609, 3081, 2553, 2656, 2640, 3341, 2392, 2800, 2816, 2384, 2610, 2884, 3105, 2078, 2774, 2810, 2359, 1913, 2099, 2826, 2782, 3196, 1640, 1772, 2451, 2756, 2692, 2327, 2251, 2765, 3157, 2197, 2964, 1807, 3461,}, 
                               {2703, 2563, 2350, 2788, 2893, 2131, 2456, 2045, 2953, 2846, 2949, 2458, 3335, 2700, 3196, 2395, 2921, 2700, 2820, 2794, 3044, 2459, 3129, 2503, 2133, 2677, 2817, 2755, 2342, 3252, 2844, 2587, 1985, 2090, 2526, 2536, 3345, 1858, 1776, 2525, 2821, 2728, 2481, 2357, 2731, 2727, 2209, 3041, 1904, 3118,}, 
                               {2473, 2558, 1932, 2003, 2571, 2455, 2475, 2119, 2815, 2734, 2366, 1752, 2570, 2362, 2590, 2266, 2866, 2817, 2388, 2078, 2821, 2062, 2483, 2548, 2571, 2284, 2627, 2571, 2091, 2359, 2627, 2300, 1762, 2229, 2023, 2426, 2982, 1811, 1775, 2426, 2675, 2285, 1702, 2080, 2387, 2925, 1874, 1970, 1352, 2517,}, 
                               {2396, 2128, 1991, 2581, 2327, 1553, 2340, 1748, 2552, 2322, 2373, 2271, 2974, 2673, 2621, 2417, 2921, 2145, 2121, 2041, 2651, 2074, 2654, 2091, 1868, 2683, 2122, 2341, 1976, 2207, 2394, 2387, 1648, 1628, 1865, 2414, 2595, 1801, 1482, 2203, 1930, 2355, 1833, 2271, 2466, 2252, 1814, 2597, 1562, 2553,}, 
                               {1739, 1902, 1699, 2182, 2500, 1367, 2044, 1344, 2254, 1898, 2236, 1595, 2302, 1970, 2231, 1928, 2343, 2120, 2341, 2012, 2457, 1983, 2123, 1693, 1343, 1990, 1930, 2221, 1686, 2286, 1899, 2112, 1740, 1863, 1931, 1922, 2614, 1573, 1493, 2171, 2377, 1823, 1817, 1607, 2189, 2111, 1818, 2380, 1676, 2330,}, 
                               {2612, 2662, 2176, 3020, 3096, 2124, 2343, 2004, 3179, 3100, 3258, 2695, 3268, 3166, 3213, 2360, 3121, 3028, 2920, 2541, 3452, 2466, 2941, 2612, 2418, 3077, 2658, 2562, 2357, 3142, 3037, 2539, 2151, 2290, 2516, 2869, 2906, 2082, 1935, 3084, 2498, 2465, 2359, 2770, 2444, 2499, 2058, 3162, 1943, 3076,}, 
                               {2476, 2330, 2143, 2664, 2769, 2151, 2585, 1912, 2690, 2611, 2493, 2172, 2933, 2456, 2706, 2293, 2714, 2546, 2390, 2421, 2962, 2205, 2525, 2427, 1980, 2385, 2699, 2665, 1846, 2729, 2353, 2327, 1745, 2029, 2480, 2495, 2969, 1540, 1639, 2187, 2539, 2369, 1993, 1970, 2466, 2775, 2013, 2592, 1619, 2948,}, 
                               {2822, 2927, 2490, 2763, 2872, 2177, 2798, 2170, 2759, 2982, 2584, 2484, 3413, 2727, 2836, 3189, 3421, 3034, 2480, 2237, 3155, 2304, 3170, 2537, 2271, 3062, 2476, 2862, 2485, 2658, 2974, 3087, 1794, 2317, 2305, 2905, 3173, 2044, 1802, 2865, 2688, 2923, 1950, 2139, 3100, 2974, 2022, 2575, 1636, 2939,}, 
                               {2345, 2105, 2041, 2709, 2642, 1933, 1723, 1816, 2940, 2861, 2656, 2199, 2963, 2570, 2884, 1953, 2540, 2308, 2568, 2359, 3043, 2157, 2848, 2352, 1845, 2360, 2273, 2378, 2095, 2533, 2667, 2336, 1630, 1840, 2637, 2538, 2704, 1548, 1709, 2322, 2265, 2312, 1995, 1866, 2135, 2541, 2102, 2645, 1649, 2984,}, 
                               {2279, 1961, 1944, 2232, 2634, 2037, 2250, 1712, 2381, 2531, 2246, 2105, 2590, 1838, 2522, 2235, 2538, 2240, 2381, 2080, 2648, 1962, 2261, 2104, 1837, 2181, 2002, 2154, 1871, 2402, 2570, 2487, 1387, 1852, 2247, 2308, 2464, 1522, 1646, 2125, 2569, 2362, 1914, 1863, 2102, 2785, 1994, 2048, 1420, 2530,}, 
                               {2881, 2530, 2394, 2907, 2966, 2355, 2497, 1953, 3037, 3151, 3355, 2846, 3292, 2898, 3326, 2324, 2958, 2591, 2740, 2834, 2882, 2499, 3087, 2914, 2363, 3007, 2754, 2427, 2580, 3171, 3037, 2796, 1705, 2037, 2868, 3192, 2734, 2106, 1821, 2492, 2838, 2578, 2127, 2206, 2377, 3292, 2255, 3070, 1745, 3062,}, 
                               {1863, 2305, 1675, 2343, 2330, 1714, 1832, 1793, 2489, 2216, 2636, 1917, 2575, 2203, 2777, 2098, 2363, 2024, 2375, 2241, 2748, 1984, 2527, 2210, 1651, 2231, 2107, 2126, 2020, 2259, 2377, 2152, 1726, 2012, 2442, 2328, 2588, 1534, 1426, 2218, 2206, 2075, 1733, 1582, 2174, 2402, 1924, 2511, 1584, 2630,}, 
                               {2288, 2303, 2453, 2422, 2290, 2074, 2319, 1975, 2791, 2669, 2496, 2085, 3361, 2716, 2859, 2328, 2884, 2461, 2227, 2134, 2796, 2052, 2791, 2450, 2085, 2674, 2170, 2521, 2265, 2549, 2714, 2544, 1716, 2044, 2267, 2401, 2792, 1620, 1859, 2367, 2094, 2778, 2024, 2264, 2416, 2500, 2196, 2385, 1648, 2696,}, 
                               {2179, 1712, 1471, 1870, 1941, 1396, 1703, 1465, 2084, 2192, 1820, 1927, 2205, 1901, 2145, 1789, 2169, 2070, 1730, 1986, 2297, 1785, 2049, 1773, 1579, 1973, 1887, 1601, 1347, 2023, 1884, 2043, 1326, 1485, 1647, 1953, 2145, 1278, 1274, 1740, 1867, 1861, 1606, 1681, 1857, 2026, 1323, 1943, 1025, 2108,}, 
                               {2505, 2007, 1787, 2529, 2519, 1619, 2012, 1593, 2340, 2629, 2409, 2362, 2636, 2618, 2581, 1831, 2486, 2331, 2244, 2328, 2562, 2105, 2496, 2149, 1871, 2427, 2292, 2096, 1978, 2592, 2084, 2273, 1612, 1547, 2193, 2637, 2358, 1716, 1517, 2119, 2315, 1997, 1742, 1515, 2005, 2452, 1736, 2502, 1580, 2514,}, 
                               {2850, 2028, 2315, 2783, 2651, 2239, 2832, 2200, 2693, 2862, 2393, 2397, 3287, 2533, 3148, 2373, 3263, 2523, 2706, 2774, 2959, 2413, 2662, 2553, 2264, 2759, 2422, 2665, 1993, 3024, 2677, 2748, 2146, 1964, 2236, 2644, 3097, 1829, 1939, 2401, 2878, 2600, 2496, 2338, 2556, 2899, 2288, 2580, 1877, 3121,}, 
                               {2605, 2287, 1809, 2726, 2158, 1999, 1972, 1999, 2397, 2644, 2582, 2481, 2646, 2556, 2915, 2340, 3007, 2180, 2647, 2473, 2973, 2265, 2673, 2657, 2034, 2831, 1841, 2168, 1968, 2722, 2896, 2490, 1931, 1904, 2183, 2756, 2834, 1570, 1451, 2498, 2330, 2319, 1945, 2051, 2017, 2570, 1779, 2489, 1726, 2882,}, 
                               {2645, 3084, 2512, 3177, 3311, 2700, 2847, 2510, 3267, 3199, 3169, 2634, 3352, 2714, 3686, 2833, 3079, 2970, 3082, 2851, 3589, 2543, 2889, 2928, 2661, 2947, 3156, 2994, 2404, 3241, 2940, 2764, 2190, 2694, 3091, 3121, 3169, 2031, 1957, 2989, 3031, 2531, 2513, 2486, 2899, 3063, 2141, 3275, 2031, 3585,}, 
                               {2865, 2566, 2297, 2821, 2832, 2264, 3054, 2271, 2865, 2912, 2800, 2475, 3334, 2997, 3282, 2554, 3439, 2831, 2708, 2774, 3085, 2575, 2779, 2821, 2519, 3040, 2797, 2746, 2289, 2981, 2696, 2862, 2289, 2268, 2376, 2989, 3210, 2160, 1973, 2641, 2910, 2580, 2225, 2309, 2783, 3122, 2307, 2800, 1908, 2997,}, 
                               {1876, 2220, 1833, 1882, 2184, 1871, 1619, 1646, 2360, 2297, 2225, 1883, 2401, 1867, 2379, 2136, 2153, 2160, 2011, 1739, 2499, 1732, 2365, 2039, 1689, 2015, 1851, 1980, 1859, 2147, 2551, 2072, 1168, 1812, 2119, 1971, 2350, 1205, 1350, 2118, 1981, 2335, 1678, 1747, 2016, 2216, 1549, 2010, 1184, 2276,}, 
                               {1832, 1746, 1743, 2111, 2112, 1441, 1924, 1331, 1934, 2075, 2339, 2135, 2427, 2410, 2319, 1786, 2399, 1985, 1787, 1766, 2007, 1854, 2058, 2068, 1525, 2461, 1539, 1750, 1819, 2233, 2120, 1983, 1415, 1397, 1867, 2309, 1751, 1531, 1335, 2161, 1893, 1907, 1520, 1420, 1785, 2074, 1512, 2243, 1397, 1985,}, 
                               {1956, 1960, 1496, 2266, 2031, 1507, 2165, 1612, 1873, 2002, 2010, 1826, 2449, 2103, 2390, 1985, 2598, 1908, 2086, 1938, 2477, 1847, 1906, 2034, 1613, 2286, 1959, 1939, 1553, 1978, 2174, 2220, 1673, 1709, 1783, 2209, 2522, 1449, 1277, 1887, 1895, 1909, 1475, 1622, 2094, 2267, 1805, 1999, 1402, 2178,}, 
                               {2069, 2092, 2110, 2169, 1981, 2150, 1803, 1671, 2813, 2553, 2492, 1860, 2656, 2366, 2922, 1674, 2633, 2137, 2581, 2389, 2618, 1996, 2404, 2559, 2195, 2482, 2028, 2232, 2203, 2554, 2802, 2506, 1700, 2023, 2214, 2492, 2834, 1544, 1751, 2181, 2192, 2246, 1909, 1991, 1897, 2703, 2092, 2327, 1694, 2614,}, 
                               {2360, 2511, 2560, 2561, 2636, 2067, 2609, 1844, 2627, 2490, 2783, 2292, 3272, 2489, 2781, 2702, 2864, 2375, 2410, 2174, 2509, 2060, 3043, 2290, 2001, 2751, 2229, 2731, 2606, 2827, 2725, 2584, 1578, 1958, 2301, 2516, 2746, 1933, 1680, 2471, 2549, 2763, 2071, 2162, 2644, 2648, 2090, 2706, 1816, 2768,}, 
                               {2191, 1966, 1707, 2257, 2448, 1888, 1860, 1576, 2301, 2470, 2346, 2036, 2355, 2051, 2404, 1920, 2380, 2148, 2288, 1902, 2656, 2023, 2058, 2207, 1720, 2124, 2014, 1888, 1540, 2307, 2569, 2159, 1357, 1757, 2120, 2172, 2424, 1330, 1432, 2050, 2139, 2086, 1702, 2029, 1799, 2413, 1752, 2045, 1277, 2314,}, 
                               {2176, 1793, 2107, 2340, 2083, 1561, 2153, 1677, 2297, 2234, 2448, 2112, 2982, 2514, 3026, 1924, 2812, 1753, 2307, 2319, 2246, 2315, 2398, 2361, 1622, 2561, 1844, 2037, 1991, 2455, 2538, 2592, 1745, 1577, 2073, 2316, 2690, 1656, 1607, 1962, 2221, 2445, 2019, 1880, 2219, 2516, 2250, 2458, 1731, 2308,}, 
                               {2359, 2300, 1940, 2981, 2894, 2164, 2284, 1990, 2717, 2677, 2824, 2502, 2741, 2373, 3261, 2204, 2729, 2236, 3012, 2669, 3173, 2327, 2450, 2495, 2091, 2577, 2445, 2492, 2018, 2970, 2718, 2394, 1979, 2038, 2701, 2756, 2832, 1691, 1628, 2506, 2705, 2169, 2330, 2110, 2212, 2708, 2047, 2963, 2012, 3191,}, 
                               {2689, 2344, 2223, 2572, 2725, 2267, 2135, 1973, 3186, 3182, 2672, 2120, 3191, 2643, 2999, 2003, 2919, 2855, 2925, 2678, 3236, 2202, 2993, 2460, 2445, 2565, 2636, 2620, 2455, 2900, 2896, 2785, 1958, 2251, 2443, 2683, 3226, 1916, 2106, 2529, 2703, 2533, 2210, 2258, 2333, 2931, 2414, 2497, 1803, 3045,}, 
                               {2640, 2581, 2161, 2601, 2713, 1722, 2173, 1591, 2729, 2786, 2765, 2427, 2837, 2540, 2814, 2460, 2944, 2616, 2784, 2328, 2884, 2350, 2746, 2202, 2132, 2846, 2323, 2220, 2331, 2743, 2800, 3046, 1692, 2152, 2059, 2710, 2945, 2134, 1735, 2585, 2501, 2376, 1999, 2488, 2439, 2614, 1911, 2719, 1741, 2532,}, 
                               {2241, 2421, 2295, 2777, 2586, 2167, 2177, 1675, 3118, 2624, 2827, 2201, 2942, 2237, 2823, 2450, 2706, 2136, 2681, 2314, 2989, 1934, 2819, 2348, 2084, 2648, 2323, 2575, 2377, 2404, 2900, 2693, 1420, 2156, 2582, 2769, 2749, 1809, 1648, 2282, 2213, 2336, 1863, 2352, 2338, 2883, 2122, 2807, 1681, 3115,}, 
                               {2460, 2519, 2087, 2956, 3067, 1885, 2543, 2285, 3159, 2735, 3237, 2396, 3318, 3079, 3516, 2664, 3372, 2378, 2867, 2413, 3157, 2704, 3044, 2659, 2145, 2943, 2453, 2612, 2410, 2444, 2982, 2640, 2238, 2128, 2542, 2818, 2950, 2354, 1885, 2901, 2690, 2471, 2210, 2472, 2854, 2766, 2404, 3123, 1950, 2952,}, 
                               {2616, 2336, 1974, 2655, 3050, 2267, 2686, 2148, 2737, 2795, 2736, 2311, 3039, 2449, 2906, 2306, 2894, 2976, 2752, 2771, 3266, 2378, 2664, 2444, 2110, 2447, 2731, 2636, 1864, 3254, 2582, 2279, 2233, 2262, 2468, 2377, 3156, 1666, 1859, 2642, 3035, 2479, 2489, 2251, 2497, 2717, 2137, 2674, 1778, 3124,}, 
                               {2264, 2276, 2108, 2503, 2525, 2060, 2567, 2051, 2538, 2446, 2820, 2075, 3400, 2373, 2978, 2244, 2732, 2273, 2443, 2483, 2688, 2044, 2823, 2348, 1927, 2461, 2576, 2449, 2235, 2784, 2710, 2284, 1890, 2000, 2371, 2232, 2910, 1751, 1672, 2155, 2463, 2606, 2157, 2229, 2524, 2608, 2428, 2538, 1657, 2782,}, 
                               {1569, 1485, 1237, 1938, 2108, 1316, 1369, 1183, 1541, 1929, 1956, 1549, 1901, 1461, 1731, 1533, 1759, 1803, 1988, 1643, 2210, 1522, 1787, 1531, 982, 1618, 1297, 1468, 1347, 2056, 1834, 1711, 1305, 1558, 1915, 1736, 1797, 1065, 1220, 1869, 2003, 1542, 1379, 1076, 1325, 1835, 1557, 1604, 1231, 1998, },
                               {1961, 1568, 1462, 1884, 1948, 1878, 2072, 1816, 2168, 2041, 1771, 1613, 2141, 1650, 2510, 1818, 2539, 1778, 2219, 2027, 2418, 1828, 1749, 2055, 1860, 1941, 1736, 1941, 1361, 1973, 2297, 2029, 1694, 1660, 1661, 1917, 2476, 1312, 1447, 1864, 2222, 1893, 1855, 1898, 1877, 2365, 1758, 1755, 1333, 2324,}, 
                               {2122, 2086, 1870, 2308, 2190, 1908, 1881, 1481, 2559, 2431, 2278, 1814, 2478, 2115, 2620, 1807, 2796, 2294, 2887, 2342, 2845, 1989, 2263, 2189, 2020, 2448, 1986, 2308, 2012, 2607, 2838, 2651, 1837, 2070, 1883, 2333, 3190, 1589, 1674, 2312, 2327, 2149, 1976, 2112, 2034, 2549, 2064, 2260, 1803, 2587,}, 
                               {2454, 2112, 2011, 2413, 2446, 1899, 2101, 1716, 2618, 2511, 2528, 2000, 2885, 2490, 2570, 2031, 2720, 2247, 2495, 2200, 2672, 2122, 2766, 2252, 1879, 2322, 2290, 2448, 2089, 2586, 2699, 2298, 1627, 1722, 2074, 2216, 3039, 1629, 1596, 2103, 2336, 2484, 1916, 2151, 2218, 2547, 2155, 2340, 1617, 2581,}, 
                               {2263, 2538, 2047, 2792, 2687, 2121, 2540, 2109, 2810, 2639, 2594, 2202, 3014, 2807, 3223, 2311, 3188, 2582, 2896, 2512, 3212, 2232, 2609, 2542, 2384, 2844, 2474, 2856, 2396, 2700, 2720, 2614, 2266, 2211, 2389, 2866, 3177, 1939, 1835, 2749, 2589, 2361, 2121, 1904, 2613, 2774, 2228, 2775, 2124, 3023,}, 
                               {2196, 2352, 1797, 2392, 2531, 1853, 2012, 1636, 3151, 2479, 2691, 2150, 2546, 2462, 2631, 2326, 2779, 2383, 2365, 2214, 3014, 2039, 2692, 2294, 2048, 2567, 2222, 2325, 2113, 2035, 2660, 2462, 1549, 2059, 2283, 2681, 2645, 1814, 1578, 2417, 2142, 2145, 1652, 2074, 2347, 2770, 1795, 2704, 1416, 2785,}, };

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestScalarMulSmall) {
    Vec2d<TypeParam> a {{4, 9}, {3, 4}};

    auto result = (TypeParam)2 * a;

    Vec2d<TypeParam> expected {{8, 18}, {6, 8}};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestScalarMulMed) {
    Vec2d<TypeParam> a {{9, 3, 0, 2, 4,},
                        {3, 0, 0, 3, 2,},
                        {1, 2, 5, 8, 5,},
                        {8, 3, 5, 3, 1,},
                        {1, 0, 3, 2, 8,},
                        {6, 1, 3, 3, 1,},
                        {0, 0, 9, 7, 2,},
                        {9, 6, 1, 4, 0,},
                        {4, 7, 5, 8, 6,},
                        {6, 1, 9, 4, 0,},
                        {8, 1, 9, 7, 5,},
                        {6, 5, 5, 2, 4,},
                        {9, 2, 4, 1, 0,},
                        {3, 5, 9, 5, 0,},
                        {1, 5, 3, 7, 4,},};

    auto result = (TypeParam)43 * a;

    Vec2d<TypeParam> expected {{387, 129, 0, 86, 172, },
                               {129, 0, 0, 129, 86, },
                               {43, 86, 215, 344, 215, },
                               {344, 129, 215, 129, 43, },
                               {43, 0, 129, 86, 344, },
                               {258, 43, 129, 129, 43, },
                               {0, 0, 387, 301, 86, },
                               {387, 258, 43, 172, 0, },
                               {172, 301, 215, 344, 258, },
                               {258, 43, 387, 172, 0, },
                               {344, 43, 387, 301, 215, },
                               {258, 215, 215, 86, 172, },
                               {387, 86, 172, 43, 0, },
                               {129, 215, 387, 215, 0, },
                               {43, 215, 129, 301, 172, },};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestScalarMulBig) {
    Vec2d<TypeParam> a {{26,2,0,36,17,5,24,37,3,12,25,28,47,26,49,18,43,3,41,39,34,31,32,19,3,25,10,19,10,40,42,12,48,2,11,2,49,10,11,22,28,39,49,32,27,6,42,26,32,32},
                        {36,21,21,19,45,15,44,8,39,31,49,49,46,43,16,39,41,41,7,12,27,20,40,19,25,44,22,13,36,20,42,32,1,13,19,33,4,36,24,30,19,47,14,46,27,41,28,28,1,12},
                        {29,21,11,13,25,4,4,7,50,23,44,11,4,47,38,4,39,13,42,28,11,45,37,32,29,28,20,20,39,12,28,33,25,12,10,37,39,49,21,29,40,4,9,16,21,40,22,39,25,10},
                        {16,20,7,27,44,1,12,13,44,25,6,4,24,45,12,9,30,49,19,12,49,25,27,7,11,9,42,48,4,7,6,5,27,12,14,11,49,11,17,33,15,12,16,2,44,6,11,33,15,30},
                        {42,22,25,35,1,13,3,20,48,35,30,44,30,34,44,37,42,11,12,46,38,40,43,49,11,47,9,7,7,11,39,50,10,20,35,49,31,8,8,17,8,29,15,21,29,44,7,46,0,46},
                        {1,21,37,17,14,46,31,30,40,19,26,2,45,12,34,27,33,12,8,14,4,0,41,37,29,27,24,49,38,6,43,6,7,12,26,26,15,20,10,25,20,20,12,3,45,36,18,28,4,43},
                        {35,5,30,4,16,40,49,22,46,26,0,4,33,12,8,21,37,40,28,37,34,1,35,9,45,16,19,50,36,35,14,31,27,29,7,17,44,19,43,17,44,42,34,31,19,47,40,1,26,43},
                        {14,47,9,35,32,16,0,15,14,25,49,50,16,3,35,46,14,24,46,35,42,11,45,14,12,38,0,11,47,47,43,34,15,34,44,42,13,19,5,50,36,26,26,3,16,23,6,44,29,43},
                        {12,50,25,13,4,15,25,33,2,33,9,12,43,27,41,33,39,45,16,8,33,19,3,28,34,43,22,4,17,18,30,49,33,49,4,23,30,20,23,40,3,26,14,31,36,4,13,2,10,0},
                        {5,14,28,37,22,11,44,15,11,3,41,42,49,40,45,16,17,6,12,40,19,21,18,27,2,35,22,23,25,48,6,14,25,12,48,29,12,5,14,10,16,37,32,3,19,24,36,50,36,32},
                        {37,27,37,42,38,8,49,11,8,21,36,17,45,38,2,39,42,38,12,12,4,31,40,19,4,38,31,37,14,41,10,15,24,14,0,18,26,37,9,35,33,10,14,32,44,5,6,37,14,22},
                        {7,15,33,31,50,33,6,14,45,40,47,4,32,15,36,1,14,36,50,27,46,38,13,32,5,8,26,22,2,49,40,19,27,44,48,5,38,4,35,38,39,18,43,43,10,19,38,31,23,37},
                        {35,27,5,18,8,34,13,3,39,31,16,37,5,10,28,1,19,30,32,48,42,8,7,27,48,28,49,14,10,36,38,31,5,21,14,36,44,3,5,2,8,15,20,39,8,41,2,30,5,35},
                        {31,32,10,35,43,21,32,31,6,37,36,15,44,5,23,33,20,33,30,34,40,22,34,22,3,13,39,13,17,30,21,32,25,40,45,25,31,20,19,19,46,21,11,2,29,41,42,9,7,33},
                        {34,22,31,36,32,1,8,17,49,39,39,27,40,39,48,12,11,7,38,26,21,23,44,2,36,24,37,17,49,24,6,34,14,12,24,32,9,50,30,16,17,12,29,49,16,8,27,46,33,26},
                        {40,38,29,3,38,36,45,37,15,24,17,34,23,5,35,44,12,29,10,21,13,29,22,23,29,5,46,25,13,42,17,16,1,14,24,6,30,7,9,9,48,48,36,28,37,32,4,17,4,16},
                        {44,3,2,32,40,35,30,41,28,46,14,41,3,44,41,13,44,36,29,30,41,40,5,44,44,30,12,22,0,31,13,8,40,8,24,48,4,19,26,46,49,3,29,6,3,34,1,21,22,38},
                        {40,22,41,30,16,25,11,6,12,48,10,26,41,43,21,5,34,33,32,18,25,22,29,33,24,34,18,31,36,43,41,49,6,10,22,37,48,7,24,16,19,45,11,1,11,38,35,4,26,16},
                        {16,49,24,32,28,43,18,31,48,23,47,8,25,36,25,39,27,13,32,0,47,20,39,44,27,19,28,44,31,8,49,9,8,34,42,25,44,9,12,25,10,36,0,39,18,36,31,20,17,35},
                        {11,24,25,44,34,13,43,11,23,8,11,15,16,5,32,44,43,0,42,13,31,23,2,14,16,32,16,39,16,1,23,49,16,25,19,38,35,29,12,22,26,8,14,22,41,37,23,34,31,33}};

    auto result = a * (TypeParam)1.5;

    Vec2d<TypeParam> expected {{39, 3, 0, 54, 25.5, 7.5, 36, 55.5, 4.5, 18, 37.5, 42, 70.5, 39, 73.5, 27, 64.5, 4.5, 61.5, 58.5, 51, 46.5, 48, 28.5, 4.5, 37.5, 15, 28.5, 15, 60, 63, 18, 72, 3, 16.5, 3, 73.5, 15, 16.5, 33, 42, 58.5, 73.5, 48, 40.5, 9, 63, 39, 48, 48, },
                               {54, 31.5, 31.5, 28.5, 67.5, 22.5, 66, 12, 58.5, 46.5, 73.5, 73.5, 69, 64.5, 24, 58.5, 61.5, 61.5, 10.5, 18, 40.5, 30, 60, 28.5, 37.5, 66, 33, 19.5, 54, 30, 63, 48, 1.5, 19.5, 28.5, 49.5, 6, 54, 36, 45, 28.5, 70.5, 21, 69, 40.5, 61.5, 42, 42, 1.5, 18, },
                               {43.5, 31.5, 16.5, 19.5, 37.5, 6, 6, 10.5, 75, 34.5, 66, 16.5, 6, 70.5, 57, 6, 58.5, 19.5, 63, 42, 16.5, 67.5, 55.5, 48, 43.5, 42, 30, 30, 58.5, 18, 42, 49.5, 37.5, 18, 15, 55.5, 58.5, 73.5, 31.5, 43.5, 60, 6, 13.5, 24, 31.5, 60, 33, 58.5, 37.5, 15, },
                               {24, 30, 10.5, 40.5, 66, 1.5, 18, 19.5, 66, 37.5, 9, 6, 36, 67.5, 18, 13.5, 45, 73.5, 28.5, 18, 73.5, 37.5, 40.5, 10.5, 16.5, 13.5, 63, 72, 6, 10.5, 9, 7.5, 40.5, 18, 21, 16.5, 73.5, 16.5, 25.5, 49.5, 22.5, 18, 24, 3, 66, 9, 16.5, 49.5, 22.5, 45, },
                               {63, 33, 37.5, 52.5, 1.5, 19.5, 4.5, 30, 72, 52.5, 45, 66, 45, 51, 66, 55.5, 63, 16.5, 18, 69, 57, 60, 64.5, 73.5, 16.5, 70.5, 13.5, 10.5, 10.5, 16.5, 58.5, 75, 15, 30, 52.5, 73.5, 46.5, 12, 12, 25.5, 12, 43.5, 22.5, 31.5, 43.5, 66, 10.5, 69, 0, 69, },
                               {1.5, 31.5, 55.5, 25.5, 21, 69, 46.5, 45, 60, 28.5, 39, 3, 67.5, 18, 51, 40.5, 49.5, 18, 12, 21, 6, 0, 61.5, 55.5, 43.5, 40.5, 36, 73.5, 57, 9, 64.5, 9, 10.5, 18, 39, 39, 22.5, 30, 15, 37.5, 30, 30, 18, 4.5, 67.5, 54, 27, 42, 6, 64.5, },
                               {52.5, 7.5, 45, 6, 24, 60, 73.5, 33, 69, 39, 0, 6, 49.5, 18, 12, 31.5, 55.5, 60, 42, 55.5, 51, 1.5, 52.5, 13.5, 67.5, 24, 28.5, 75, 54, 52.5, 21, 46.5, 40.5, 43.5, 10.5, 25.5, 66, 28.5, 64.5, 25.5, 66, 63, 51, 46.5, 28.5, 70.5, 60, 1.5, 39, 64.5, },
                               {21, 70.5, 13.5, 52.5, 48, 24, 0, 22.5, 21, 37.5, 73.5, 75, 24, 4.5, 52.5, 69, 21, 36, 69, 52.5, 63, 16.5, 67.5, 21, 18, 57, 0, 16.5, 70.5, 70.5, 64.5, 51, 22.5, 51, 66, 63, 19.5, 28.5, 7.5, 75, 54, 39, 39, 4.5, 24, 34.5, 9, 66, 43.5, 64.5, },
                               {18, 75, 37.5, 19.5, 6, 22.5, 37.5, 49.5, 3, 49.5, 13.5, 18, 64.5, 40.5, 61.5, 49.5, 58.5, 67.5, 24, 12, 49.5, 28.5, 4.5, 42, 51, 64.5, 33, 6, 25.5, 27, 45, 73.5, 49.5, 73.5, 6, 34.5, 45, 30, 34.5, 60, 4.5, 39, 21, 46.5, 54, 6, 19.5, 3, 15, 0, },
                               {7.5, 21, 42, 55.5, 33, 16.5, 66, 22.5, 16.5, 4.5, 61.5, 63, 73.5, 60, 67.5, 24, 25.5, 9, 18, 60, 28.5, 31.5, 27, 40.5, 3, 52.5, 33, 34.5, 37.5, 72, 9, 21, 37.5, 18, 72, 43.5, 18, 7.5, 21, 15, 24, 55.5, 48, 4.5, 28.5, 36, 54, 75, 54, 48, },
                               {55.5, 40.5, 55.5, 63, 57, 12, 73.5, 16.5, 12, 31.5, 54, 25.5, 67.5, 57, 3, 58.5, 63, 57, 18, 18, 6, 46.5, 60, 28.5, 6, 57, 46.5, 55.5, 21, 61.5, 15, 22.5, 36, 21, 0, 27, 39, 55.5, 13.5, 52.5, 49.5, 15, 21, 48, 66, 7.5, 9, 55.5, 21, 33, },
                               {10.5, 22.5, 49.5, 46.5, 75, 49.5, 9, 21, 67.5, 60, 70.5, 6, 48, 22.5, 54, 1.5, 21, 54, 75, 40.5, 69, 57, 19.5, 48, 7.5, 12, 39, 33, 3, 73.5, 60, 28.5, 40.5, 66, 72, 7.5, 57, 6, 52.5, 57, 58.5, 27, 64.5, 64.5, 15, 28.5, 57, 46.5, 34.5, 55.5, },
                               {52.5, 40.5, 7.5, 27, 12, 51, 19.5, 4.5, 58.5, 46.5, 24, 55.5, 7.5, 15, 42, 1.5, 28.5, 45, 48, 72, 63, 12, 10.5, 40.5, 72, 42, 73.5, 21, 15, 54, 57, 46.5, 7.5, 31.5, 21, 54, 66, 4.5, 7.5, 3, 12, 22.5, 30, 58.5, 12, 61.5, 3, 45, 7.5, 52.5, },
                               {46.5, 48, 15, 52.5, 64.5, 31.5, 48, 46.5, 9, 55.5, 54, 22.5, 66, 7.5, 34.5, 49.5, 30, 49.5, 45, 51, 60, 33, 51, 33, 4.5, 19.5, 58.5, 19.5, 25.5, 45, 31.5, 48, 37.5, 60, 67.5, 37.5, 46.5, 30, 28.5, 28.5, 69, 31.5, 16.5, 3, 43.5, 61.5, 63, 13.5, 10.5, 49.5, },
                               {51, 33, 46.5, 54, 48, 1.5, 12, 25.5, 73.5, 58.5, 58.5, 40.5, 60, 58.5, 72, 18, 16.5, 10.5, 57, 39, 31.5, 34.5, 66, 3, 54, 36, 55.5, 25.5, 73.5, 36, 9, 51, 21, 18, 36, 48, 13.5, 75, 45, 24, 25.5, 18, 43.5, 73.5, 24, 12, 40.5, 69, 49.5, 39, },
                               {60, 57, 43.5, 4.5, 57, 54, 67.5, 55.5, 22.5, 36, 25.5, 51, 34.5, 7.5, 52.5, 66, 18, 43.5, 15, 31.5, 19.5, 43.5, 33, 34.5, 43.5, 7.5, 69, 37.5, 19.5, 63, 25.5, 24, 1.5, 21, 36, 9, 45, 10.5, 13.5, 13.5, 72, 72, 54, 42, 55.5, 48, 6, 25.5, 6, 24, },
                               {66, 4.5, 3, 48, 60, 52.5, 45, 61.5, 42, 69, 21, 61.5, 4.5, 66, 61.5, 19.5, 66, 54, 43.5, 45, 61.5, 60, 7.5, 66, 66, 45, 18, 33, 0, 46.5, 19.5, 12, 60, 12, 36, 72, 6, 28.5, 39, 69, 73.5, 4.5, 43.5, 9, 4.5, 51, 1.5, 31.5, 33, 57, },
                               {60, 33, 61.5, 45, 24, 37.5, 16.5, 9, 18, 72, 15, 39, 61.5, 64.5, 31.5, 7.5, 51, 49.5, 48, 27, 37.5, 33, 43.5, 49.5, 36, 51, 27, 46.5, 54, 64.5, 61.5, 73.5, 9, 15, 33, 55.5, 72, 10.5, 36, 24, 28.5, 67.5, 16.5, 1.5, 16.5, 57, 52.5, 6, 39, 24, },
                               {24, 73.5, 36, 48, 42, 64.5, 27, 46.5, 72, 34.5, 70.5, 12, 37.5, 54, 37.5, 58.5, 40.5, 19.5, 48, 0, 70.5, 30, 58.5, 66, 40.5, 28.5, 42, 66, 46.5, 12, 73.5, 13.5, 12, 51, 63, 37.5, 66, 13.5, 18, 37.5, 15, 54, 0, 58.5, 27, 54, 46.5, 30, 25.5, 52.5, },
                               {16.5, 36, 37.5, 66, 51, 19.5, 64.5, 16.5, 34.5, 12, 16.5, 22.5, 24, 7.5, 48, 66, 64.5, 0, 63, 19.5, 46.5, 34.5, 3, 21, 24, 48, 24, 58.5, 24, 1.5, 34.5, 73.5, 24, 37.5, 28.5, 57, 52.5, 43.5, 18, 33, 39, 12, 21, 33, 61.5, 55.5, 34.5, 51, 46.5, 49.5,} };

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestMatDivSmall) {
    Vec2d<TypeParam> a {{8, 1}, {30, 12}};
    Vec2d<TypeParam> b {{2, 1}, {10, 3}};

    auto result = a / b;

    Vec2d<TypeParam> expected {{4, 1}, {3, 4}};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestMatDivMed) {
    Vec2d<TypeParam> a {{9, 3, 3, 2, 4,},
                        {3, 3, 3, 3, 2,},
                        {1, 2, 5, 8, 5,},
                        {8, 3, 5, 3, 1,},
                        {1, 3, 3, 2, 8,},
                        {6, 1, 3, 3, 1,},
                        {3, 3, 9, 7, 2,},
                        {9, 6, 1, 4, 3,},
                        {4, 7, 5, 8, 6,},
                        {6, 1, 9, 4, 3,},
                        {8, 1, 9, 7, 5,},
                        {6, 5, 5, 2, 4,},
                        {9, 2, 4, 1, 3,},
                        {3, 5, 9, 5, 3,},
                        {1, 5, 3, 7, 4,},};
    Vec2d<TypeParam> b {{9, 3, 3, 2, 4,},
                        {3, 3, 3, 3, 2,},
                        {1, 2, 5, 8, 5,},
                        {8, 3, 5, 3, 1,},
                        {1, 3, 3, 2, 8,},
                        {6, 1, 3, 3, 1,},
                        {3, 3, 9, 7, 2,},
                        {9, 6, 1, 4, 3,},
                        {4, 7, 5, 8, 6,},
                        {6, 1, 9, 4, 3,},
                        {8, 1, 9, 7, 5,},
                        {6, 5, 5, 2, 4,},
                        {9, 2, 4, 1, 3,},
                        {3, 5, 9, 5, 3,},
                        {1, 5, 3, 7, 4,},};

    auto result = a / b;

    Vec2d<TypeParam> expected {{1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},
                               {1, 1, 1, 1, 1,},};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestMatDivBig) {
    Vec2d<TypeParam> a {{95,70,40,61,46,74,85,35,16,82,93,61,84,28,21,49,74,29,16,25,96,75,75,40,83,65,45,17,78,42,92,82,22,15,28,54,54,64,60,64,45,75,73,67,78,15,60,32,66,89},
                        {16,81,91,54,71,82,51,92,46,71,25,37,40,79,87,37,24,39,45,43,34,61,61,46,79,24,25,79,41,74,87,89,62,74,94,52,36,29,28,21,21,89,85,47,14,34,88,26,79,50},
                        {76,17,47,98,67,14,25,48,11,88,69,71,29,45,89,79,72,72,20,65,24,82,21,35,80,16,91,66,57,50,50,78,69,20,79,46,36,75,47,74,77,92,57,79,23,80,77,43,46,45},
                        {56,44,81,10,20,96,38,65,77,26,63,58,80,25,38,54,30,26,18,61,44,78,27,92,14,62,51,18,70,40,67,87,42,17,28,61,54,26,73,65,30,40,82,19,80,56,53,52,55,48},
                        {59,59,84,43,10,51,33,62,19,32,13,91,14,94,61,21,31,65,78,64,71,68,37,27,98,17,92,95,22,70,67,41,43,61,83,33,92,94,60,39,95,99,52,74,71,74,63,89,57,49},
                        {59,79,34,93,55,97,77,19,39,71,67,56,38,89,79,22,96,78,73,91,47,58,12,12,55,65,92,16,37,28,86,87,80,89,86,18,39,99,77,57,82,25,75,56,48,80,87,62,84,79},
                        {53,89,11,24,90,78,27,20,11,87,68,93,24,75,66,23,52,53,16,23,45,82,76,86,38,84,38,59,76,47,92,82,60,25,31,39,69,24,27,30,95,42,24,51,77,96,48,43,79,26},
                        {18,47,68,13,75,35,31,30,97,50,50,92,87,78,77,77,46,35,18,75,60,98,37,52,63,32,28,84,77,39,74,19,86,29,14,92,64,16,75,68,43,21,19,60,89,22,36,79,49,36},
                        {98,73,98,89,49,60,47,56,38,76,97,45,52,21,29,37,32,63,68,19,91,19,42,63,88,26,43,94,56,73,79,94,63,26,16,75,86,62,75,24,38,59,92,90,13,53,69,71,86,74},
                        {87,11,27,76,76,37,60,52,68,95,33,69,70,58,29,76,78,35,36,90,49,17,26,54,31,48,89,37,60,92,25,32,24,82,19,26,37,56,18,77,20,73,56,67,86,24,21,72,48,38},
                        {56,85,29,77,24,79,80,43,93,41,21,44,71,57,37,33,91,60,84,90,28,86,18,59,35,28,39,83,49,45,63,85,86,83,48,70,19,23,69,67,54,75,50,17,32,68,43,16,68,30},
                        {11,82,88,78,15,41,84,40,89,52,72,64,40,61,92,83,60,11,89,70,71,42,84,94,90,11,19,17,12,81,89,56,86,40,14,47,76,73,23,38,21,33,94,48,55,44,15,50,25,34},
                        {35,54,48,61,21,37,77,90,44,38,37,82,38,23,35,32,25,97,57,86,78,11,60,41,78,32,50,46,66,15,88,32,27,88,89,78,37,72,11,29,23,71,93,74,64,84,28,74,28,47},
                        {65,38,14,98,80,18,98,67,15,54,44,62,92,33,67,36,53,60,33,57,56,50,89,33,52,79,38,48,23,17,48,53,53,68,75,85,99,93,35,16,87,18,44,77,66,22,23,25,22,63},
                        {62,82,49,61,58,81,30,98,47,19,32,97,84,92,72,75,60,43,49,29,45,17,95,49,62,30,66,64,33,73,42,82,63,44,54,53,27,38,47,34,32,29,69,59,36,83,64,43,12,66},
                        {57,18,74,42,16,60,64,59,18,56,57,52,73,27,63,14,20,29,23,58,29,97,23,63,86,50,34,42,94,26,11,18,78,43,19,69,65,61,33,83,47,20,87,38,39,91,32,58,46,68},
                        {67,68,60,30,96,17,65,13,72,67,14,61,45,63,73,19,14,38,65,90,96,45,23,46,83,24,92,73,84,49,81,67,32,39,77,16,19,73,12,42,47,73,54,53,62,57,71,76,36,49},
                        {35,19,19,37,40,89,11,75,19,64,60,68,50,82,63,28,37,28,21,94,67,85,27,87,83,88,35,72,49,57,88,87,28,36,69,59,96,33,20,34,58,92,74,86,52,91,98,60,35,32},
                        {67,72,36,55,55,76,30,22,99,85,71,75,17,33,21,67,41,86,92,84,18,12,28,32,64,24,21,23,84,30,95,45,64,87,84,36,97,72,49,88,92,62,95,60,23,85,34,18,15,27},
                        {71,39,90,77,77,58,36,17,14,76,97,43,87,42,39,43,88,19,70,92,53,85,43,24,15,63,81,90,81,11,20,69,29,17,61,36,80,61,53,53,51,13,59,64,20,94,88,74,60,84}};
    Vec2d<TypeParam> b {{12,16,83,96,86,55,64,15,59,20,38,78,12,82,94,77,64,51,61,94,83,66,66,45,14,85,54,94,24,44,38,45,35,49,90,24,30,17,49,99,46,92,93,50,77,19,26,44,70,73},
                        {87,84,70,32,75,45,33,19,89,92,25,28,62,68,75,21,71,70,74,49,55,80,26,91,83,96,38,66,66,95,57,80,79,57,34,43,13,34,41,28,80,73,33,44,77,25,90,18,25,28},
                        {44,55,76,19,71,44,15,19,79,64,17,96,88,47,18,57,91,70,84,19,22,54,33,96,40,37,47,27,50,47,92,28,63,20,32,13,29,91,63,67,95,80,44,97,77,90,68,57,48,29},
                        {59,97,26,70,93,99,15,77,43,61,35,73,17,28,80,74,72,82,96,58,30,22,24,24,85,49,94,24,79,25,79,23,42,40,22,15,75,23,41,31,12,33,78,97,27,52,77,65,67,33},
                        {80,37,97,83,70,45,72,58,41,53,96,77,81,69,95,20,95,95,79,91,76,96,72,18,78,13,42,41,78,15,11,40,96,47,74,55,32,27,51,42,86,87,28,74,72,98,90,60,46,65},
                        {42,51,16,69,44,70,12,57,31,96,51,91,84,92,98,96,37,14,95,70,43,78,57,73,97,29,61,63,99,75,70,14,40,58,90,24,79,38,10,39,30,24,76,70,27,26,13,14,16,61},
                        {64,76,56,28,25,50,54,24,50,96,60,96,83,85,24,11,85,96,40,54,76,72,47,72,54,66,96,44,69,52,21,17,97,59,12,27,65,92,75,36,57,11,72,41,35,22,76,76,11,26},
                        {12,52,70,96,34,11,21,43,77,22,27,21,35,67,62,23,41,59,91,78,66,42,63,40,41,13,38,32,39,25,55,33,38,73,23,50,55,41,50,69,16,85,97,54,68,59,31,79,39,81},
                        {90,67,90,39,90,71,13,67,21,20,14,91,81,86,15,20,81,24,34,21,60,83,63,76,42,30,73,90,79,65,74,58,60,31,50,73,71,47,30,98,35,17,55,60,59,24,44,43,75,14},
                        {64,88,50,48,70,46,33,56,64,89,94,36,26,37,21,79,84,24,84,63,26,48,44,63,34,32,81,32,73,44,87,58,18,22,63,21,96,69,46,88,17,90,77,75,85,15,90,75,48,96},
                        {22,17,40,20,66,75,43,85,26,62,35,92,89,64,57,63,46,63,22,52,29,78,78,62,22,52,68,17,25,37,75,74,49,83,48,91,42,45,72,72,30,48,58,53,87,34,21,78,51,84},
                        {86,27,86,35,88,81,30,57,11,23,70,80,34,74,66,64,45,30,56,18,51,85,27,73,15,46,31,39,25,20,49,21,38,60,16,51,69,92,95,64,62,80,60,99,65,85,84,61,96,24},
                        {34,13,88,61,68,44,29,31,80,25,98,51,77,31,73,11,13,84,59,52,19,92,13,36,71,93,26,13,36,53,51,68,50,89,42,51,78,72,70,46,54,78,21,86,46,73,84,48,32,93},
                        {84,41,21,12,68,80,56,33,86,60,91,91,69,20,94,64,15,36,31,53,47,59,92,73,47,22,62,63,64,61,84,15,57,25,51,58,82,48,76,35,72,42,91,34,73,63,81,83,96,87},
                        {42,89,69,52,14,48,59,74,89,13,40,97,72,99,84,76,33,11,16,53,91,40,53,83,64,44,61,41,71,91,33,30,62,27,57,57,36,59,17,78,86,46,84,46,89,56,45,38,54,56},
                        {28,91,39,97,38,60,81,74,42,81,73,81,50,45,18,93,13,58,94,78,82,50,50,34,68,26,32,62,80,58,27,38,15,73,70,28,34,99,38,31,22,74,13,40,46,85,68,76,21,91},
                        {19,91,24,97,91,59,64,52,68,30,16,39,50,55,54,73,52,88,81,95,92,37,26,27,31,72,64,90,75,48,27,96,79,51,90,64,12,38,80,65,43,74,36,14,70,88,65,74,75,21},
                        {60,25,75,21,17,66,19,99,53,84,62,87,10,39,53,73,80,77,63,76,37,12,21,75,43,48,22,95,36,94,54,88,24,75,19,95,69,28,36,39,95,96,28,20,73,95,48,29,86,21},
                        {47,89,94,44,39,55,63,97,83,46,73,82,25,90,42,26,38,73,82,16,88,38,44,23,72,61,30,83,40,63,92,28,97,18,32,48,74,71,92,28,40,85,23,38,63,81,73,34,28,25},
                        {97,94,43,32,46,13,55,17,45,57,86,75,92,48,23,25,68,95,40,52,87,76,65,58,76,97,41,22,31,59,43,15,79,98,29,56,64,49,17,98,39,12,77,45,52,70,44,59,84,19}};

    auto result = a / b;

    Vec2d<TypeParam> expected {{7.916666508, 4.375, 0.4819277227, 0.6354166865, 0.5348837376, 1.345454574, 1.328125, 2.333333254, 0.2711864412, 4.099999905, 2.447368383, 0.7820512652, 7, 0.3414634168, 0.2234042585, 0.6363636255, 1.15625, 0.5686274767, 0.2622950673, 0.2659574449, 1.156626463, 1.136363626, 1.136363626, 0.8888888955, 5.928571224, 0.7647058964, 0.8333333135, 0.1808510572, 3.25, 0.9545454383, 2.421052694, 1.822222233, 0.6285714507, 0.306122452, 0.3111111224, 2.25, 1.799999952, 3.764705896, 1.224489808, 0.6464646459, 0.9782608747, 0.8152173758, 0.7849462628, 1.340000033, 1.012987018, 0.7894737124, 2.307692289, 0.7272727489, 0.9428571463, 1.219178081, },
                               {0.1839080453, 0.9642857313, 1.299999952, 1.6875, 0.9466666579, 1.822222233, 1.545454502, 4.842105389, 0.5168539286, 0.7717391253, 1, 1.321428537, 0.6451612711, 1.161764741, 1.159999967, 1.761904716, 0.3380281627, 0.5571428537, 0.6081081033, 0.8775510192, 0.6181818247, 0.7624999881, 2.346153736, 0.505494535, 0.9518072009, 0.25, 0.6578947306, 1.196969748, 0.6212121248, 0.7789473534, 1.526315808, 1.112499952, 0.7848101258, 1.298245668, 2.764705896, 1.209302306, 2.769230843, 0.8529411554, 0.6829268336, 0.75, 0.2624999881, 1.219178081, 2.575757504, 1.068181872, 0.1818181872, 1.360000014, 0.9777777791, 1.444444418, 3.160000086, 1.785714269, },
                               {1.727272749, 0.3090909123, 0.6184210777, 5.157894611, 0.9436619878, 0.3181818128, 1.666666627, 2.526315689, 0.1392405033, 1.375, 4.058823586, 0.7395833135, 0.3295454681, 0.9574468136, 4.944444656, 1.38596487, 0.7912088037, 1.028571486, 0.2380952388, 3.421052694, 1.090909123, 1.518518567, 0.6363636255, 0.3645833433, 2, 0.4324324429, 1.93617022, 2.444444418, 1.139999986, 1.06382978, 0.5434782505, 2.785714388, 1.09523809, 1, 2.46875, 3.538461447, 1.241379261, 0.8241758347, 0.7460317612, 1.104477644, 0.8105263114, 1.149999976, 1.295454502, 0.8144329786, 0.2987012863, 0.8888888955, 1.132352948, 0.7543859482, 0.9583333135, 1.551724195, },
                               {0.9491525292, 0.4536082447, 3.115384579, 0.1428571492, 0.215053767, 0.9696969986, 2.533333302, 0.844155848, 1.790697694, 0.4262295067, 1.799999952, 0.7945205569, 4.705882549, 0.8928571343, 0.474999994, 0.729729712, 0.4166666567, 0.3170731664, 0.1875, 1.051724195, 1.466666698, 3.545454502, 1.125, 3.833333254, 0.1647058874, 1.265306115, 0.5425531864, 0.75, 0.8860759735, 1.600000024, 0.8481012583, 3.782608747, 1, 0.4250000119, 1.272727251, 4.066666603, 0.7200000286, 1.130434752, 1.780487776, 2.096774101, 2.5, 1.212121248, 1.051282048, 0.1958762854, 2.962962866, 1.076923132, 0.6883116961, 0.8000000119, 0.820895493, 1.454545498, },
                               {0.7375000119, 1.594594598, 0.8659793735, 0.5180723071, 0.1428571492, 1.133333325, 0.4583333433, 1.068965554, 0.4634146392, 0.6037735939, 0.1354166716, 1.181818128, 0.1728395075, 1.362318873, 0.6421052814, 1.049999952, 0.3263157904, 0.6842105389, 0.9873417616, 0.703296721, 0.9342105389, 0.7083333135, 0.5138888955, 1.5, 1.256410241, 1.307692289, 2.190476179, 2.317073107, 0.282051295, 4.666666508, 6.090909004, 1.024999976, 0.4479166567, 1.297872305, 1.121621609, 0.6000000238, 2.875, 3.481481552, 1.176470637, 0.928571403, 1.104651213, 1.137930989, 1.857142806, 1, 0.9861111045, 0.7551020384, 0.6999999881, 1.483333349, 1.239130378, 0.7538461685, },
                               {1.40476191, 1.549019575, 2.125, 1.347826123, 1.25, 1.385714293, 6.416666508, 0.3333333433, 1.258064508, 0.7395833135, 1.313725471, 0.6153846383, 0.4523809552, 0.9673913121, 0.8061224222, 0.2291666716, 2.594594479, 5.571428776, 0.7684210539, 1.299999952, 1.0930233, 0.7435897589, 0.2105263174, 0.1643835604, 0.5670102835, 2.241379261, 1.508196712, 0.2539682686, 0.373737365, 0.3733333349, 1.228571415, 6.214285851, 2, 1.534482718, 0.9555555582, 0.75, 0.4936708808, 2.605263233, 7.699999809, 1.461538434, 2.733333349, 1.041666627, 0.9868420959, 0.8000000119, 1.777777791, 3.076923132, 6.692307472, 4.428571224, 5.25, 1.295081973, },
                               {0.828125, 1.171052575, 0.1964285672, 0.8571428657, 3.599999905, 1.559999943, 0.5, 0.8333333135, 0.2199999988, 0.90625, 1.133333325, 0.96875, 0.2891566157, 0.8823529482, 2.75, 2.090909004, 0.611764729, 0.5520833135, 0.400000006, 0.4259259403, 0.5921052694, 1.138888836, 1.617021322, 1.194444418, 0.7037037015, 1.272727251, 0.3958333433, 1.340909123, 1.101449251, 0.9038461447, 4.380952358, 4.823529243, 0.6185566783, 0.4237288237, 2.583333254, 1.444444418, 1.061538458, 0.2608695626, 0.3600000143, 0.8333333135, 1.666666627, 3.818181753, 0.3333333433, 1.243902445, 2.200000048, 4.363636494, 0.6315789223, 0.5657894611, 7.181818008, 1, },
                               {1.5, 0.9038461447, 0.9714285731, 0.1354166716, 2.205882311, 3.181818247, 1.476190448, 0.6976743937, 1.259740233, 2.272727251, 1.851851821, 4.380952358, 2.485714197, 1.164179087, 1.241935492, 3.347826004, 1.121951222, 0.5932203531, 0.1978022009, 0.961538434, 0.9090909362, 2.333333254, 0.5873016119, 1.299999952, 1.536585331, 2.461538553, 0.7368420959, 2.625, 1.974358916, 1.559999943, 1.345454574, 0.5757575631, 2.263157845, 0.3972602785, 0.6086956263, 1.840000033, 1.163636327, 0.3902438879, 1.5, 0.9855072498, 2.6875, 0.2470588237, 0.1958762854, 1.111111164, 1.308823586, 0.3728813529, 1.161290288, 1, 1.256410241, 0.4444444478, },
                               {1.088888884, 1.089552283, 1.088888884, 2.282051325, 0.5444444418, 0.8450704217, 3.615384579, 0.8358209133, 1.809523821, 3.799999952, 6.928571224, 0.4945054948, 0.6419752836, 0.2441860437, 1.933333278, 1.850000024, 0.3950617313, 2.625, 2, 0.9047619104, 1.516666651, 0.2289156616, 0.6666666865, 0.8289473653, 2.095238209, 0.8666666746, 0.5890411139, 1.044444442, 0.708860755, 1.123076916, 1.067567587, 1.620689631, 1.049999952, 0.8387096524, 0.3199999928, 1.027397275, 1.211267591, 1.319148898, 2.5, 0.2448979616, 1.08571434, 3.470588207, 1.672727227, 1.5, 0.2203389853, 2.208333254, 1.568181872, 1.651162744, 1.146666646, 5.285714149, },
                               {1.359375, 0.125, 0.5400000215, 1.583333373, 1.08571434, 0.8043478131, 1.818181872, 0.928571403, 1.0625, 1.067415714, 0.3510638177, 1.916666627, 2.692307711, 1.567567587, 1.380952358, 0.9620253444, 0.928571403, 1.458333373, 0.4285714328, 1.428571463, 1.884615421, 0.3541666567, 0.5909090638, 0.8571428657, 0.9117646813, 1.5, 1.098765373, 1.15625, 0.8219178319, 2.090909004, 0.287356317, 0.5517241359, 1.333333373, 3.727272749, 0.3015873134, 1.238095284, 0.3854166567, 0.8115941882, 0.3913043439, 0.875, 1.176470637, 0.8111110926, 0.7272727489, 0.8933333158, 1.011764765, 1.600000024, 0.2333333343, 0.9599999785, 1, 0.3958333433, },
                               {2.545454502, 5, 0.7250000238, 3.849999905, 0.3636363745, 1.053333282, 1.860465169, 0.5058823824, 3.576923132, 0.6612903476, 0.6000000238, 0.4782608747, 0.7977527976, 0.890625, 0.6491228342, 0.5238095522, 1.978260875, 0.9523809552, 3.818181753, 1.730769277, 0.9655172229, 1.102564096, 0.2307692319, 0.9516128898, 1.590909123, 0.538461566, 0.5735294223, 4.882352829, 1.960000038, 1.216216207, 0.8399999738, 1.14864862, 1.755102038, 1, 1, 0.769230783, 0.4523809552, 0.5111111403, 0.9583333135, 0.930555582, 1.799999952, 1.5625, 0.8620689511, 0.3207547069, 0.3678160906, 2, 2.047619104, 0.2051282078, 1.333333373, 0.3571428657, },
                               {0.1279069781, 3.037037134, 1.023255825, 2.228571415, 0.1704545468, 0.5061728358, 2.799999952, 0.7017543912, 8.090909004, 2.260869503, 1.028571486, 0.8000000119, 1.176470637, 0.8243243098, 1.393939376, 1.296875, 1.333333373, 0.3666666746, 1.589285731, 3.888888836, 1.392156839, 0.4941176474, 3.111111164, 1.287671208, 6, 0.2391304374, 0.6129032373, 0.4358974397, 0.4799999893, 4.050000191, 1.816326499, 2.666666746, 2.263157845, 0.6666666865, 0.875, 0.9215686321, 1.101449251, 0.7934782505, 0.2421052605, 0.59375, 0.3387096822, 0.412499994, 1.566666722, 0.4848484993, 0.8461538553, 0.5176470876, 0.1785714328, 0.8196721077, 0.2604166567, 1.416666627, },
                               {1.029411793, 4.153846264, 0.5454545617, 1, 0.3088235259, 0.8409090638, 2.655172348, 2.903225899, 0.5500000119, 1.519999981, 0.3775510192, 1.607843161, 0.4935064912, 0.7419354916, 0.4794520438, 2.909090996, 1.923076868, 1.15476191, 0.966101706, 1.653846145, 4.105263233, 0.1195652187, 4.615384579, 1.138888836, 1.098591566, 0.3440860212, 1.923076868, 3.538461447, 1.833333373, 0.2830188572, 1.725490212, 0.470588237, 0.5400000215, 0.9887640476, 2.119047642, 1.529411793, 0.4743589759, 1, 0.1571428627, 0.6304348111, 0.4259259403, 0.9102563858, 4.428571224, 0.8604651093, 1.391304374, 1.150684953, 0.3333333433, 1.541666627, 0.875, 0.505376339, },
                               {0.7738095522, 0.9268292785, 0.6666666865, 8.166666985, 1.176470637, 0.224999994, 1.75, 2.030303001, 0.1744185984, 0.8999999762, 0.4835164845, 0.6813187003, 1.333333373, 1.649999976, 0.7127659321, 0.5625, 3.533333302, 1.666666627, 1.064516187, 1.07547164, 1.191489339, 0.8474576473, 0.9673913121, 0.4520547986, 1.106382966, 3.590909004, 0.6129032373, 0.7619047761, 0.359375, 0.2786885202, 0.571428597, 3.533333302, 0.9298245907, 2.720000029, 1.470588207, 1.465517282, 1.207317114, 1.9375, 0.4605263174, 0.4571428597, 1.208333373, 0.4285714328, 0.4835164845, 2.264705896, 0.9041095972, 0.3492063582, 0.2839506269, 0.3012048304, 0.2291666716, 0.7241379023, },
                               {1.476190448, 0.9213483334, 0.710144937, 1.173076868, 4.142857075, 1.6875, 0.5084745884, 1.324324369, 0.5280898809, 1.461538434, 0.8000000119, 1, 1.166666627, 0.9292929173, 0.8571428657, 0.9868420959, 1.818181872, 3.909090996, 3.0625, 0.5471698046, 0.4945054948, 0.4250000119, 1.792452812, 0.5903614163, 0.96875, 0.6818181872, 1.081967235, 1.560975552, 0.4647887349, 0.802197814, 1.272727251, 2.733333349, 1.016129017, 1.629629612, 0.947368443, 0.9298245907, 0.75, 0.6440678239, 2.764705896, 0.4358974397, 0.3720930219, 0.6304348111, 0.821428597, 1.282608747, 0.404494375, 1.482142806, 1.422222257, 1.131578922, 0.2222222239, 1.178571463, },
                               {2.035714388, 0.1978022009, 1.897435904, 0.4329896867, 0.4210526347, 1, 0.7901234627, 0.7972972989, 0.4285714328, 0.6913580298, 0.7808219194, 0.6419752836, 1.460000038, 0.6000000238, 3.5, 0.1505376399, 1.538461566, 0.5, 0.2446808517, 0.7435897589, 0.3536585271, 1.940000057, 0.4600000083, 1.852941155, 1.264705896, 1.923076868, 1.0625, 0.6774193645, 1.174999952, 0.4482758641, 0.407407403, 0.4736842215, 5.199999809, 0.5890411139, 0.2714285851, 2.464285612, 1.911764741, 0.6161616445, 0.8684210777, 2.677419424, 2.136363745, 0.2702702582, 6.692307472, 0.9499999881, 0.8478260636, 1.070588231, 0.470588237, 0.7631579041, 2.190476179, 0.7472527623, },
                               {3.526315689, 0.7472527623, 2.5, 0.3092783391, 1.054945111, 0.2881355882, 1.015625, 0.25, 1.058823586, 2.233333349, 0.875, 1.56410253, 0.8999999762, 1.145454526, 1.351851821, 0.2602739632, 0.269230783, 0.4318181872, 0.8024691343, 0.947368443, 1.043478251, 1.216216207, 0.8846153617, 1.703703761, 2.677419424, 0.3333333433, 1.4375, 0.8111110926, 1.120000005, 1.020833373, 3, 0.6979166865, 0.4050633013, 0.7647058964, 0.8555555344, 0.25, 1.583333373, 1.921052575, 0.150000006, 0.6461538672, 1.0930233, 0.9864864945, 1.5, 3.785714388, 0.8857142925, 0.6477272511, 1.092307687, 1.027027011, 0.4799999893, 2.333333254, },
                               {0.5833333135, 0.7599999905, 0.2533333302, 1.761904716, 2.352941275, 1.348484874, 0.5789473653, 0.7575757504, 0.3584905565, 0.7619047761, 0.9677419066, 0.7816091776, 5, 2.102564096, 1.188679218, 0.383561641, 0.462500006, 0.3636363745, 0.3333333433, 1.236842155, 1.810810804, 7.083333492, 1.285714269, 1.159999967, 1.930232525, 1.833333373, 1.590909123, 0.7578947544, 1.361111164, 0.606382966, 1.629629612, 0.9886363745, 1.166666627, 0.4799999893, 3.631578922, 0.6210526228, 1.391304374, 1.178571463, 0.555555582, 0.8717948794, 0.6105263233, 0.9583333135, 2.642857075, 4.300000191, 0.7123287916, 0.9578947425, 2.041666746, 2.068965435, 0.4069767296, 1.523809552, },
                               {1.425531864, 0.80898875, 0.3829787374, 1.25, 1.410256386, 1.381818175, 0.4761904776, 0.2268041223, 1.192771077, 1.847826123, 0.972602725, 0.9146341681, 0.6800000072, 0.3666666746, 0.5, 2.576923132, 1.078947425, 1.178082228, 1.121951222, 5.25, 0.2045454532, 0.3157894611, 0.6363636255, 1.391304374, 0.8888888955, 0.3934426308, 0.6999999881, 0.2771084309, 2.099999905, 0.4761904776, 1.032608747, 1.607142806, 0.6597937942, 4.833333492, 2.625, 0.75, 1.310810804, 1.014084458, 0.5326086879, 3.142857075, 2.299999952, 0.7294117808, 4.13043499, 1.578947425, 0.3650793731, 1.049382687, 0.4657534361, 0.5294117928, 0.5357142687, 1.080000043, },
                               {0.7319587469, 0.4148936272, 2.0930233, 2.40625, 1.673913002, 4.461538315, 0.6545454264, 1, 0.3111111224, 1.333333373, 1.127906919, 0.573333323, 0.9456521869, 0.875, 1.695652127, 1.720000029, 1.294117689, 0.200000003, 1.75, 1.769230723, 0.6091954112, 1.118421078, 0.6615384817, 0.4137931168, 0.1973684281, 0.6494845152, 1.975609779, 4.090909004, 2.612903118, 0.1864406765, 0.4651162922, 4.599999905, 0.3670886159, 0.1734693944, 2.103448391, 0.6428571343, 1.25, 1.244897962, 3.117647171, 0.5408163071, 1.307692289, 1.083333373, 0.7662337422, 1.422222257, 0.3846153915, 1.342857122, 2, 1.254237294, 0.7142857313, 4.421052456,}};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestPowerSmall) {
    Vec2d<TypeParam> a {{4, 9}, {3, 4}};

    auto result = power(a, (TypeParam)2);

    Vec2d<TypeParam> expected {{16, 81}, {9, 16}};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestPowerMed) {
    Vec2d<TypeParam> a {{54,13,14,64,51,83,35,59,30,30,76,75,81,17,61,81,16,61,87,38},
                        {83,36,25,58,38,82,13,64,69,56,51,85,33,94,58,31,55,89,75,47},
                        {93,51,52,55,89,20,89,29,13,27,37,57,95,89,43,29,65,63,11,84},
                        {70,64,11,88,78,24,93,18,72,20,51,89,99,26,76,25,13,80,34,52},
                        {19,93,55,56,27,77,68,73,40,71,32,41,17,39,37,21,50,60,69,39},
                        {89,86,46,24,88,26,17,74,92,72,26,97,69,77,18,33,45,14,67,88},
                        {10,32,98,81,58,53,78,74,37,12,53,89,90,13,89,28,71,41,33,33},
                        {28,39,66,47,37,49,95,91,70,65,24,52,41,77,99,37,84,62,60,33},
                        {75,68,74,34,63,99,90,86,83,42,52,43,20,82,27,25,48,59,55,79},
                        {94,80,86,97,92,73,58,52,84,18,88,65,84,43,92,36,73,67,21,26}};

    auto result = power(a, (TypeParam)1.5);

    Vec2d<TypeParam> expected {{396.8173523, 46.87216568, 52.3832016, 512, 364.2128601, 756.1660156, 207.0627899, 453.1875916, 164.3167725, 164.3167725, 662.5526123, 649.519043, 729, 70.09279633, 476.4252319, 729, 64, 476.4252319, 811.4819946, 234.2477264, },
                               {756.1660156, 216, 125, 441.7148438, 234.2477264, 742.5415649, 46.87216568, 512, 573.1570435, 419.0656128, 364.2128601, 783.6612549, 189.5705719, 911.3638306, 441.7148438, 172.6006927, 407.8909302, 839.6243286, 649.519043, 322.2157593, },
                               {896.8594971, 364.2128601, 374.9773254, 407.8909302, 839.6243286, 89.44271851, 839.6243286, 156.1697845, 46.87216568, 140.2961121, 225.0622101, 430.3405762, 925.9454346, 839.6243286, 281.9698486, 156.1697845, 524.0467529, 500.0469971, 36.48287201, 769.8727417, },
                               {585.6620483, 512, 36.48287201, 825.5131836, 688.8773193, 117.5755081, 896.8594971, 76.36753082, 610.9402466, 89.44271851, 364.2128601, 839.6243286, 985.0375366, 132.5745087, 662.5526123, 125, 46.87216568, 715.541748, 198.2523651, 374.9773254, },
                               {82.81907654, 896.8594971, 407.8909302, 419.0656128, 140.2961121, 675.6722412, 560.7423706, 623.7122803, 252.9822083, 598.2566528, 181.0193329, 262.5281067, 70.09279633, 243.5549164, 225.0622101, 96.23409271, 353.5533752, 464.7579956, 573.1570435, 243.5549164, },
                               {839.6243286, 797.531189, 311.9871826, 117.5755081, 825.5131836, 132.5745087, 70.09279633, 636.5720825, 882.4329834, 610.9402466, 132.5745087, 955.3392334, 573.1570435, 675.6722412, 76.36753082, 189.5705719, 301.8691711, 52.3832016, 548.4186401, 825.5131836, },
                               {31.62277603, 181.0193329, 970.1505127, 729, 441.7148438, 385.8458252, 688.8773193, 636.5720825, 225.0622101, 41.56921768, 385.8458252, 839.6243286, 853.8149414, 46.87216568, 839.6243286, 148.1620789, 598.2566528, 262.5281067, 189.5705719, 189.5705719, },
                               {148.1620789, 243.5549164, 536.1865234, 322.2157593, 225.0622101, 343, 925.9454346, 868.0846558, 585.6620483, 524.0467529, 117.5755081, 374.9773254, 262.5281067, 675.6722412, 985.0375366, 225.0622101, 769.8727417, 488.1884766, 464.7579956, 189.5705719, },
                               {649.519043, 560.7423706, 636.5720825, 198.2523651, 500.0469971, 985.0375366, 853.8149414, 797.531189, 756.1660156, 272.1911011, 374.9773254, 281.9698486, 89.44271851, 742.5415649, 140.2961121, 125, 332.5537415, 453.1875916, 407.8909302, 702.1673584, },
                               {911.3638306, 715.541748, 797.531189, 955.3392334, 882.4329834, 623.7122803, 441.7148438, 374.9773254, 769.8727417, 76.36753082, 825.5131836, 524.0467529, 769.8727417, 281.9698486, 882.4329834, 216, 623.7122803, 548.4186401, 96.23409271, 132.5745087, }};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestPowerBig) {
    Vec2d<TypeParam> a {{5,2,7,9,4,9,3,5,5,8,3,5,4,8,5,10,5,7,2,5,8,6,4,9,9,4,2,7,6,3,6,3,10,8,4,4,3,6,7,7,4,8,3,3,6,5,5,4,6,2,8,3,3,7,4,7,9,8,2,2,2,10,9,8,6,3,9,6,2,7,9,3,5,10,4},
                        {5,4,7,5,3,3,6,10,1,9,2,5,5,2,5,9,5,10,3,7,9,2,2,6,6,2,7,9,2,8,9,5,7,2,5,5,1,8,8,9,6,10,1,4,3,5,4,5,8,8,5,9,9,4,6,10,8,8,7,7,3,10,5,7,5,2,7,8,5,5,2,4,7,2,5},
                        {4,7,9,4,9,8,4,4,4,4,5,10,1,3,9,9,3,2,4,6,10,3,5,9,8,9,6,7,4,2,10,1,7,6,9,6,5,8,9,8,4,8,4,6,1,3,10,4,5,3,5,10,9,8,5,4,6,7,7,3,4,1,3,9,8,3,6,9,8,1,4,8,3,7,5},
                        {5,7,6,9,6,6,2,10,1,4,4,4,5,9,7,7,4,6,6,4,2,9,5,2,2,9,7,4,9,7,10,9,4,10,4,3,3,4,8,2,6,5,9,4,4,6,6,3,8,6,6,9,7,6,2,5,8,4,2,1,7,2,5,9,4,7,7,2,7,2,3,3,10,5,4},
                        {2,9,7,9,7,6,10,2,2,5,5,1,6,3,8,6,9,5,3,8,8,9,3,4,4,5,4,8,5,5,5,6,2,5,8,7,5,8,8,5,4,4,6,9,6,7,5,2,4,3,10,10,1,5,8,3,9,10,1,5,2,5,6,6,1,3,2,5,2,2,3,5,7,7,9},
                        {4,9,10,5,3,9,2,2,9,6,9,6,9,1,9,8,9,2,8,4,2,1,6,9,2,6,3,9,3,4,9,1,7,4,10,8,8,6,2,1,7,3,6,2,9,9,4,5,8,2,5,8,9,4,1,2,3,8,2,2,6,1,5,4,4,7,7,10,8,4,3,1,4,7,3},
                        {9,4,2,6,6,4,2,9,4,8,10,1,8,3,3,1,7,4,9,4,1,4,5,7,7,3,9,3,7,1,4,6,2,8,1,8,6,5,6,7,1,2,9,6,10,2,10,8,4,8,2,8,5,8,8,9,2,3,6,4,9,5,6,6,1,4,7,2,5,7,2,5,5,4,3},
                        {7,4,10,3,5,6,1,8,6,8,9,8,6,5,6,6,8,8,4,9,2,6,1,7,8,6,8,9,9,6,6,5,2,9,9,7,7,9,6,4,9,6,7,8,3,3,9,5,7,1,4,1,10,6,8,8,7,10,7,8,8,7,6,6,7,4,8,8,2,5,4,4,6,2,9},
                        {9,5,2,1,6,9,4,4,9,2,2,6,2,9,7,5,6,6,2,2,7,8,9,6,8,3,5,6,7,8,3,6,10,8,1,1,4,2,7,6,6,5,1,8,5,5,6,3,8,8,8,2,6,3,1,8,3,6,6,7,6,4,4,3,7,8,7,9,5,1,3,5,9,8,2},
                        {4,3,8,7,2,9,9,9,4,7,3,4,6,2,9,6,4,9,8,3,4,4,6,1,5,6,6,9,8,2,2,9,6,3,7,5,5,8,3,9,3,5,6,5,8,3,1,9,5,6,3,6,4,4,10,4,8,3,9,9,10,7,9,9,5,3,2,4,4,8,9,2,7,7,9},
                        {4,8,7,7,10,10,8,1,7,9,6,9,7,8,9,2,2,4,8,6,3,4,3,6,2,2,10,5,9,10,7,7,5,7,8,7,9,4,5,1,10,4,3,10,3,2,9,1,10,4,7,9,3,5,6,2,5,10,3,3,2,4,10,10,8,5,6,6,9,4,5,4,3,2,9},
                        {7,7,8,2,3,9,6,7,2,1,7,1,7,7,3,6,8,4,5,3,2,3,9,3,8,2,8,2,5,7,8,4,6,2,9,3,7,8,3,9,10,9,5,5,7,9,6,1,5,8,9,1,5,8,6,8,1,9,7,1,5,10,10,6,4,6,5,9,4,6,7,8,9,4,7},
                        {4,8,8,8,8,4,4,7,6,5,7,4,2,4,7,9,1,3,7,8,4,3,10,4,7,10,9,6,9,9,5,4,6,8,3,2,9,4,4,9,2,4,3,9,4,10,7,8,6,2,8,7,2,1,2,5,4,3,2,9,7,3,2,6,4,3,4,6,4,8,5,6,1,9,8},
                        {2,4,8,4,4,9,7,6,5,8,6,7,4,7,10,4,9,1,8,4,8,4,2,5,3,5,9,10,8,8,8,9,7,7,5,2,5,7,9,9,10,2,9,5,5,5,4,4,8,2,7,9,4,1,10,8,3,8,5,9,4,3,9,7,7,3,6,8,10,4,5,9,7,4,9},
                        {8,2,2,3,2,2,1,3,7,9,7,3,9,6,8,2,1,2,5,5,2,1,8,6,7,7,1,5,3,4,3,5,5,2,9,4,4,7,3,9,9,5,3,9,10,4,3,7,1,4,4,4,10,2,10,6,2,8,5,8,4,8,5,2,7,6,3,1,10,3,2,2,2,5,5},
                        {6,9,8,2,6,1,8,7,9,4,5,8,2,4,8,2,6,8,5,2,3,3,4,8,6,7,2,6,7,9,8,4,10,7,6,7,7,5,6,4,7,5,4,10,6,1,5,7,5,2,2,6,9,3,5,7,2,5,3,8,4,6,8,4,5,8,5,5,7,10,3,10,5,2,9},
                        {3,2,4,10,8,2,7,2,6,3,4,1,3,7,5,3,5,7,4,5,5,8,6,4,2,4,2,9,8,5,8,7,9,3,7,1,2,3,8,4,4,8,9,6,9,5,6,6,9,8,7,3,5,4,5,9,5,8,4,4,9,2,2,2,2,6,5,4,9,4,9,8,2,8,6},
                        {8,5,4,5,9,3,8,8,1,6,5,3,8,8,8,3,5,4,5,1,1,6,3,3,5,4,5,8,9,5,8,9,3,4,4,9,9,1,4,3,2,5,10,10,4,6,7,9,2,6,1,7,7,2,3,8,1,10,3,9,9,8,2,10,2,6,2,1,8,3,10,4,2,9,3},
                        {4,4,4,8,2,2,6,3,7,3,4,4,4,6,3,7,5,4,8,4,2,6,6,1,2,8,8,8,7,6,5,1,3,4,3,6,3,5,7,3,8,9,5,8,3,4,3,2,10,6,6,5,10,2,5,8,1,3,5,5,8,10,4,6,6,7,7,5,3,4,10,2,5,1,3},
                        {2,9,8,6,7,3,3,4,6,8,7,9,8,4,6,8,6,3,9,1,3,2,5,8,9,7,6,8,7,10,7,4,9,2,3,7,7,2,9,6,4,7,3,4,9,6,4,8,2,1,2,5,7,9,2,8,5,3,6,10,9,3,5,7,6,6,5,3,3,10,6,4,9,1,8},
                        {7,8,2,9,9,7,7,3,2,9,9,4,5,6,2,3,5,6,8,2,10,4,5,6,4,2,9,3,2,9,8,4,9,1,6,7,5,8,4,8,4,6,4,2,7,4,2,9,8,7,9,1,1,7,9,3,8,8,1,3,7,5,6,10,2,8,3,4,6,3,3,1,5,3,10},
                        {6,2,4,2,6,6,4,3,9,2,6,8,6,7,5,4,8,3,7,1,9,4,5,5,6,2,4,9,1,3,5,2,1,8,2,9,5,4,5,8,10,9,2,8,8,5,3,7,8,2,6,9,4,7,5,10,1,6,4,8,6,10,6,3,3,5,4,9,1,2,8,7,6,7,2},
                        {6,5,7,1,3,2,7,4,3,7,1,2,3,8,9,8,8,3,8,7,5,9,6,5,3,3,4,6,2,5,9,4,2,1,4,7,2,5,2,1,5,2,4,5,6,1,1,5,6,9,6,3,6,8,6,4,3,2,2,3,2,6,1,5,9,8,8,2,9,1,2,7,3,7,4},
                        {2,6,2,9,7,4,3,2,3,5,9,10,6,1,7,4,10,5,3,6,2,7,2,1,9,2,9,7,7,10,8,2,2,4,5,2,10,4,2,3,6,5,4,9,7,4,5,6,10,6,5,9,3,8,6,8,2,6,10,7,4,7,8,6,10,3,9,1,2,6,9,9,7,10,9},
                        {5,3,10,9,2,3,3,1,7,9,7,9,10,10,9,8,7,9,4,4,1,2,4,7,5,3,8,2,6,6,9,1,2,4,10,6,3,5,1,5,6,9,5,7,6,9,1,7,3,9,10,9,6,3,2,7,8,10,1,1,7,4,4,6,5,8,5,8,3,10,7,8,1,2,4},
                        {3,9,6,8,7,6,5,9,2,7,8,8,10,7,1,7,4,5,5,3,4,1,3,1,4,7,6,9,1,4,3,2,9,3,7,7,2,9,4,2,1,1,5,2,2,8,5,10,10,2,5,7,9,2,7,2,8,4,8,7,8,2,7,8,7,2,2,7,5,8,2,9,5,4,6},
                        {2,9,7,7,5,3,5,10,4,8,4,1,8,6,3,8,3,3,8,8,5,4,4,1,4,7,7,7,4,5,6,5,2,7,3,4,3,3,7,5,7,9,9,4,4,8,3,8,1,5,5,4,6,6,2,5,2,4,4,9,3,10,7,9,5,8,9,2,8,3,5,9,8,7,6},
                        {4,9,1,2,4,10,5,3,4,8,6,8,2,4,9,5,1,8,2,7,5,3,9,9,8,5,3,9,8,4,5,2,2,1,3,8,10,5,6,9,2,7,9,10,1,6,9,7,9,4,6,4,7,4,1,4,4,9,4,5,9,4,6,4,4,4,9,10,9,2,1,7,10,1,10},
                        {4,5,3,4,4,4,7,7,3,5,6,1,10,5,6,10,5,6,8,5,9,3,2,3,7,4,2,9,6,8,5,5,8,7,6,7,8,6,7,2,8,8,3,9,10,3,5,7,4,10,1,4,1,5,6,9,6,1,9,9,7,6,1,2,6,4,9,1,7,8,6,1,9,4,10},
                        {6,2,4,8,4,4,5,4,5,3,5,5,4,7,2,3,6,5,5,6,7,9,8,8,9,6,4,5,4,7,7,7,8,9,5,8,2,8,9,6,5,6,2,1,1,7,5,9,4,4,8,8,8,7,2,2,3,4,3,2,8,1,8,6,10,2,2,5,6,9,7,7,1,8,5},
                        {10,8,8,8,3,9,2,3,4,5,4,9,2,7,8,6,3,10,9,6,6,6,3,4,10,1,3,2,6,3,4,8,7,3,3,1,9,4,7,2,3,4,5,4,4,8,10,7,6,6,3,3,6,7,3,7,9,5,9,9,3,8,9,1,3,4,7,8,3,8,4,8,6,2,10},
                        {1,4,3,4,7,3,5,3,3,3,5,3,2,9,4,1,2,7,3,2,9,8,8,1,5,4,4,7,10,5,4,4,3,2,5,2,4,7,8,3,7,3,3,8,3,8,6,5,2,7,7,9,6,4,10,6,3,2,3,9,10,5,10,6,4,6,7,1,3,8,8,2,5,9,8},
                        {3,9,4,10,3,9,9,5,6,8,1,2,5,10,10,9,3,7,6,8,4,9,2,10,2,7,6,6,9,7,7,10,2,7,3,9,6,6,7,5,3,8,4,5,5,3,7,6,6,10,6,9,1,1,9,5,4,6,9,5,8,7,7,1,7,8,3,9,5,3,9,9,3,8,9},
                        {5,5,6,9,4,4,5,1,1,5,8,3,6,7,5,5,7,4,2,7,6,4,2,10,1,3,8,5,5,9,4,9,7,6,6,1,6,4,1,8,4,9,3,7,5,1,8,10,2,10,6,7,8,5,9,8,8,5,4,2,1,7,6,4,3,2,7,5,7,5,4,1,6,3,3},
                        {2,9,2,2,5,6,2,6,4,2,5,7,2,8,3,9,2,6,8,1,2,7,5,5,6,9,9,2,10,8,2,8,8,7,9,3,8,4,6,4,5,8,3,7,5,4,1,1,9,5,10,1,4,2,2,4,4,7,3,1,6,4,2,8,9,1,3,9,4,5,9,4,8,4,3},
                        {4,6,10,8,1,10,4,8,1,9,10,6,5,5,10,8,9,2,9,8,7,10,5,6,8,4,5,7,8,7,5,2,4,9,9,5,6,3,2,3,2,2,7,1,2,2,9,7,7,9,8,10,7,3,7,3,9,2,4,4,5,9,5,6,2,6,7,5,9,6,8,2,5,10,6},
                        {5,10,8,6,8,6,8,4,6,3,3,3,7,6,1,9,6,9,2,10,3,6,9,6,3,2,8,6,3,4,3,7,5,9,7,9,9,7,10,9,5,10,4,8,9,3,7,3,10,4,4,8,7,2,6,1,3,5,7,5,2,9,4,4,5,2,6,7,3,5,9,9,9,4,6},
                        {6,5,5,6,10,2,6,1,8,5,8,6,1,8,4,2,9,2,5,4,5,9,4,7,6,6,2,3,6,7,4,6,3,2,5,9,5,8,7,2,3,7,2,6,9,6,9,6,10,6,3,8,4,7,3,6,10,3,5,3,9,7,3,6,8,8,6,4,1,6,2,3,8,8,4},
                        {8,5,4,8,10,5,2,9,2,7,6,8,7,7,10,6,6,3,7,6,2,9,3,1,4,8,7,6,1,6,3,7,5,8,5,4,1,5,8,3,4,9,10,2,4,8,5,9,5,8,4,2,9,8,4,3,10,2,7,8,9,3,1,2,9,9,9,2,8,3,4,9,3,5,4},
                        {4,8,10,2,10,3,3,6,2,3,3,5,1,5,7,2,2,1,4,7,2,6,8,4,9,4,9,8,5,8,1,5,3,7,6,9,2,5,8,6,1,4,8,8,3,9,10,3,3,4,2,6,9,9,7,2,1,4,7,4,4,2,9,6,9,7,7,8,3,2,1,5,6,3,9},
                        {9,7,8,4,4,9,9,9,5,2,6,2,7,4,2,6,8,6,4,1,7,3,7,7,1,9,9,10,8,7,2,3,3,1,3,8,8,1,10,3,9,8,10,2,6,8,10,4,3,9,7,2,3,2,2,8,6,8,5,8,2,3,3,7,6,5,6,10,3,9,2,9,5,7,3},
                        {10,10,4,7,3,6,6,7,6,6,5,4,4,7,8,4,5,9,10,9,2,8,1,4,2,6,5,9,5,7,10,7,8,10,3,7,5,7,7,8,8,6,9,9,3,8,10,10,3,9,2,9,3,8,7,3,8,2,6,7,10,3,8,4,10,2,9,2,9,1,8,9,5,10,3},
                        {7,4,4,3,8,9,6,10,5,5,7,7,7,7,3,1,3,5,2,2,2,3,7,10,6,2,7,9,7,7,2,5,9,10,5,3,10,1,4,5,6,5,9,6,10,9,3,4,7,4,8,6,9,4,4,8,10,7,9,3,1,4,5,9,4,9,6,6,4,4,7,3,5,1,7},
                        {7,3,7,1,6,5,3,2,9,3,6,5,7,4,6,7,3,8,6,8,4,1,4,3,4,4,2,1,9,5,3,1,8,7,7,5,7,4,10,1,9,6,6,8,4,8,6,7,2,5,4,6,10,10,8,3,3,4,6,4,7,4,2,7,6,3,4,7,6,6,7,8,9,3,10},
                        {2,2,4,4,8,8,4,2,9,8,4,4,6,7,5,7,5,2,7,4,5,4,6,2,8,6,2,8,5,7,2,9,6,8,9,5,6,5,9,4,4,7,6,5,3,6,1,3,9,4,1,9,5,9,9,8,9,1,10,6,2,1,6,1,6,8,9,8,6,4,6,9,7,3,9},
                        {10,5,3,3,8,4,2,3,4,6,3,7,3,9,7,3,5,10,4,1,6,4,9,4,8,8,6,9,4,3,6,2,6,9,2,5,7,8,5,8,9,8,5,10,10,8,2,2,5,4,9,8,9,4,2,4,8,9,7,9,4,3,5,8,3,5,4,6,3,5,3,9,6,5,5},
                        {9,6,6,8,6,6,2,5,7,3,4,8,8,10,6,6,9,10,4,9,3,6,6,2,9,4,7,4,9,6,10,2,4,2,4,6,1,5,9,8,3,7,9,9,9,7,2,9,2,10,2,1,9,1,3,8,3,1,3,5,8,9,5,2,3,6,5,2,5,6,5,2,5,3,4},
                        {8,3,7,7,8,3,3,6,5,1,4,3,8,6,1,7,7,4,6,3,5,1,9,9,2,5,3,4,4,3,6,6,4,2,1,2,4,7,6,6,7,7,2,6,3,9,7,2,2,8,9,9,7,6,7,5,4,5,3,8,6,9,8,7,8,5,2,8,2,9,6,4,3,9,6},
                        {8,5,9,9,3,3,4,6,3,2,4,3,5,3,8,4,2,10,2,10,6,6,9,9,6,2,3,5,5,4,4,3,6,6,5,6,5,1,5,4,3,10,5,9,7,3,8,1,2,9,5,7,10,9,8,8,9,1,5,5,8,3,7,9,7,4,9,6,8,9,5,5,3,6,10},
                        {1,3,1,3,1,3,5,3,8,6,4,2,5,4,5,7,9,4,3,5,4,8,7,8,9,7,9,5,8,7,6,6,4,8,7,9,3,1,8,5,8,8,2,8,9,10,3,8,3,2,9,1,8,8,3,5,2,5,2,9,1,3,8,10,6,6,6,8,3,10,7,4,6,1,4}};

    auto result = power(a, (TypeParam)3);

    Vec2d<TypeParam> expected {{125, 8, 343, 729, 64, 729, 27, 125, 125, 512, 27, 125, 64, 512, 125, 1000, 125, 343, 8, 125, 512, 216, 64, 729, 729, 64, 8, 343, 216, 27, 216, 27, 1000, 512, 64, 64, 27, 216, 343, 343, 64, 512, 27, 27, 216, 125, 125, 64, 216, 8, 512, 27, 27, 343, 64, 343, 729, 512, 8, 8, 8, 1000, 729, 512, 216, 27, 729, 216, 8, 343, 729, 27, 125, 1000, 64, },
                               {125, 64, 343, 125, 27, 27, 216, 1000, 1, 729, 8, 125, 125, 8, 125, 729, 125, 1000, 27, 343, 729, 8, 8, 216, 216, 8, 343, 729, 8, 512, 729, 125, 343, 8, 125, 125, 1, 512, 512, 729, 216, 1000, 1, 64, 27, 125, 64, 125, 512, 512, 125, 729, 729, 64, 216, 1000, 512, 512, 343, 343, 27, 1000, 125, 343, 125, 8, 343, 512, 125, 125, 8, 64, 343, 8, 125, },
                               {64, 343, 729, 64, 729, 512, 64, 64, 64, 64, 125, 1000, 1, 27, 729, 729, 27, 8, 64, 216, 1000, 27, 125, 729, 512, 729, 216, 343, 64, 8, 1000, 1, 343, 216, 729, 216, 125, 512, 729, 512, 64, 512, 64, 216, 1, 27, 1000, 64, 125, 27, 125, 1000, 729, 512, 125, 64, 216, 343, 343, 27, 64, 1, 27, 729, 512, 27, 216, 729, 512, 1, 64, 512, 27, 343, 125, },
                               {125, 343, 216, 729, 216, 216, 8, 1000, 1, 64, 64, 64, 125, 729, 343, 343, 64, 216, 216, 64, 8, 729, 125, 8, 8, 729, 343, 64, 729, 343, 1000, 729, 64, 1000, 64, 27, 27, 64, 512, 8, 216, 125, 729, 64, 64, 216, 216, 27, 512, 216, 216, 729, 343, 216, 8, 125, 512, 64, 8, 1, 343, 8, 125, 729, 64, 343, 343, 8, 343, 8, 27, 27, 1000, 125, 64, },
                               {8, 729, 343, 729, 343, 216, 1000, 8, 8, 125, 125, 1, 216, 27, 512, 216, 729, 125, 27, 512, 512, 729, 27, 64, 64, 125, 64, 512, 125, 125, 125, 216, 8, 125, 512, 343, 125, 512, 512, 125, 64, 64, 216, 729, 216, 343, 125, 8, 64, 27, 1000, 1000, 1, 125, 512, 27, 729, 1000, 1, 125, 8, 125, 216, 216, 1, 27, 8, 125, 8, 8, 27, 125, 343, 343, 729, },
                               {64, 729, 1000, 125, 27, 729, 8, 8, 729, 216, 729, 216, 729, 1, 729, 512, 729, 8, 512, 64, 8, 1, 216, 729, 8, 216, 27, 729, 27, 64, 729, 1, 343, 64, 1000, 512, 512, 216, 8, 1, 343, 27, 216, 8, 729, 729, 64, 125, 512, 8, 125, 512, 729, 64, 1, 8, 27, 512, 8, 8, 216, 1, 125, 64, 64, 343, 343, 1000, 512, 64, 27, 1, 64, 343, 27, },
                               {729, 64, 8, 216, 216, 64, 8, 729, 64, 512, 1000, 1, 512, 27, 27, 1, 343, 64, 729, 64, 1, 64, 125, 343, 343, 27, 729, 27, 343, 1, 64, 216, 8, 512, 1, 512, 216, 125, 216, 343, 1, 8, 729, 216, 1000, 8, 1000, 512, 64, 512, 8, 512, 125, 512, 512, 729, 8, 27, 216, 64, 729, 125, 216, 216, 1, 64, 343, 8, 125, 343, 8, 125, 125, 64, 27, },
                               {343, 64, 1000, 27, 125, 216, 1, 512, 216, 512, 729, 512, 216, 125, 216, 216, 512, 512, 64, 729, 8, 216, 1, 343, 512, 216, 512, 729, 729, 216, 216, 125, 8, 729, 729, 343, 343, 729, 216, 64, 729, 216, 343, 512, 27, 27, 729, 125, 343, 1, 64, 1, 1000, 216, 512, 512, 343, 1000, 343, 512, 512, 343, 216, 216, 343, 64, 512, 512, 8, 125, 64, 64, 216, 8, 729, },
                               {729, 125, 8, 1, 216, 729, 64, 64, 729, 8, 8, 216, 8, 729, 343, 125, 216, 216, 8, 8, 343, 512, 729, 216, 512, 27, 125, 216, 343, 512, 27, 216, 1000, 512, 1, 1, 64, 8, 343, 216, 216, 125, 1, 512, 125, 125, 216, 27, 512, 512, 512, 8, 216, 27, 1, 512, 27, 216, 216, 343, 216, 64, 64, 27, 343, 512, 343, 729, 125, 1, 27, 125, 729, 512, 8, },
                               {64, 27, 512, 343, 8, 729, 729, 729, 64, 343, 27, 64, 216, 8, 729, 216, 64, 729, 512, 27, 64, 64, 216, 1, 125, 216, 216, 729, 512, 8, 8, 729, 216, 27, 343, 125, 125, 512, 27, 729, 27, 125, 216, 125, 512, 27, 1, 729, 125, 216, 27, 216, 64, 64, 1000, 64, 512, 27, 729, 729, 1000, 343, 729, 729, 125, 27, 8, 64, 64, 512, 729, 8, 343, 343, 729, },
                               {64, 512, 343, 343, 1000, 1000, 512, 1, 343, 729, 216, 729, 343, 512, 729, 8, 8, 64, 512, 216, 27, 64, 27, 216, 8, 8, 1000, 125, 729, 1000, 343, 343, 125, 343, 512, 343, 729, 64, 125, 1, 1000, 64, 27, 1000, 27, 8, 729, 1, 1000, 64, 343, 729, 27, 125, 216, 8, 125, 1000, 27, 27, 8, 64, 1000, 1000, 512, 125, 216, 216, 729, 64, 125, 64, 27, 8, 729, },
                               {343, 343, 512, 8, 27, 729, 216, 343, 8, 1, 343, 1, 343, 343, 27, 216, 512, 64, 125, 27, 8, 27, 729, 27, 512, 8, 512, 8, 125, 343, 512, 64, 216, 8, 729, 27, 343, 512, 27, 729, 1000, 729, 125, 125, 343, 729, 216, 1, 125, 512, 729, 1, 125, 512, 216, 512, 1, 729, 343, 1, 125, 1000, 1000, 216, 64, 216, 125, 729, 64, 216, 343, 512, 729, 64, 343, },
                               {64, 512, 512, 512, 512, 64, 64, 343, 216, 125, 343, 64, 8, 64, 343, 729, 1, 27, 343, 512, 64, 27, 1000, 64, 343, 1000, 729, 216, 729, 729, 125, 64, 216, 512, 27, 8, 729, 64, 64, 729, 8, 64, 27, 729, 64, 1000, 343, 512, 216, 8, 512, 343, 8, 1, 8, 125, 64, 27, 8, 729, 343, 27, 8, 216, 64, 27, 64, 216, 64, 512, 125, 216, 1, 729, 512, },
                               {8, 64, 512, 64, 64, 729, 343, 216, 125, 512, 216, 343, 64, 343, 1000, 64, 729, 1, 512, 64, 512, 64, 8, 125, 27, 125, 729, 1000, 512, 512, 512, 729, 343, 343, 125, 8, 125, 343, 729, 729, 1000, 8, 729, 125, 125, 125, 64, 64, 512, 8, 343, 729, 64, 1, 1000, 512, 27, 512, 125, 729, 64, 27, 729, 343, 343, 27, 216, 512, 1000, 64, 125, 729, 343, 64, 729, },
                               {512, 8, 8, 27, 8, 8, 1, 27, 343, 729, 343, 27, 729, 216, 512, 8, 1, 8, 125, 125, 8, 1, 512, 216, 343, 343, 1, 125, 27, 64, 27, 125, 125, 8, 729, 64, 64, 343, 27, 729, 729, 125, 27, 729, 1000, 64, 27, 343, 1, 64, 64, 64, 1000, 8, 1000, 216, 8, 512, 125, 512, 64, 512, 125, 8, 343, 216, 27, 1, 1000, 27, 8, 8, 8, 125, 125, },
                               {216, 729, 512, 8, 216, 1, 512, 343, 729, 64, 125, 512, 8, 64, 512, 8, 216, 512, 125, 8, 27, 27, 64, 512, 216, 343, 8, 216, 343, 729, 512, 64, 1000, 343, 216, 343, 343, 125, 216, 64, 343, 125, 64, 1000, 216, 1, 125, 343, 125, 8, 8, 216, 729, 27, 125, 343, 8, 125, 27, 512, 64, 216, 512, 64, 125, 512, 125, 125, 343, 1000, 27, 1000, 125, 8, 729, },
                               {27, 8, 64, 1000, 512, 8, 343, 8, 216, 27, 64, 1, 27, 343, 125, 27, 125, 343, 64, 125, 125, 512, 216, 64, 8, 64, 8, 729, 512, 125, 512, 343, 729, 27, 343, 1, 8, 27, 512, 64, 64, 512, 729, 216, 729, 125, 216, 216, 729, 512, 343, 27, 125, 64, 125, 729, 125, 512, 64, 64, 729, 8, 8, 8, 8, 216, 125, 64, 729, 64, 729, 512, 8, 512, 216, },
                               {512, 125, 64, 125, 729, 27, 512, 512, 1, 216, 125, 27, 512, 512, 512, 27, 125, 64, 125, 1, 1, 216, 27, 27, 125, 64, 125, 512, 729, 125, 512, 729, 27, 64, 64, 729, 729, 1, 64, 27, 8, 125, 1000, 1000, 64, 216, 343, 729, 8, 216, 1, 343, 343, 8, 27, 512, 1, 1000, 27, 729, 729, 512, 8, 1000, 8, 216, 8, 1, 512, 27, 1000, 64, 8, 729, 27, },
                               {64, 64, 64, 512, 8, 8, 216, 27, 343, 27, 64, 64, 64, 216, 27, 343, 125, 64, 512, 64, 8, 216, 216, 1, 8, 512, 512, 512, 343, 216, 125, 1, 27, 64, 27, 216, 27, 125, 343, 27, 512, 729, 125, 512, 27, 64, 27, 8, 1000, 216, 216, 125, 1000, 8, 125, 512, 1, 27, 125, 125, 512, 1000, 64, 216, 216, 343, 343, 125, 27, 64, 1000, 8, 125, 1, 27, },
                               {8, 729, 512, 216, 343, 27, 27, 64, 216, 512, 343, 729, 512, 64, 216, 512, 216, 27, 729, 1, 27, 8, 125, 512, 729, 343, 216, 512, 343, 1000, 343, 64, 729, 8, 27, 343, 343, 8, 729, 216, 64, 343, 27, 64, 729, 216, 64, 512, 8, 1, 8, 125, 343, 729, 8, 512, 125, 27, 216, 1000, 729, 27, 125, 343, 216, 216, 125, 27, 27, 1000, 216, 64, 729, 1, 512, },
                               {343, 512, 8, 729, 729, 343, 343, 27, 8, 729, 729, 64, 125, 216, 8, 27, 125, 216, 512, 8, 1000, 64, 125, 216, 64, 8, 729, 27, 8, 729, 512, 64, 729, 1, 216, 343, 125, 512, 64, 512, 64, 216, 64, 8, 343, 64, 8, 729, 512, 343, 729, 1, 1, 343, 729, 27, 512, 512, 1, 27, 343, 125, 216, 1000, 8, 512, 27, 64, 216, 27, 27, 1, 125, 27, 1000, },
                               {216, 8, 64, 8, 216, 216, 64, 27, 729, 8, 216, 512, 216, 343, 125, 64, 512, 27, 343, 1, 729, 64, 125, 125, 216, 8, 64, 729, 1, 27, 125, 8, 1, 512, 8, 729, 125, 64, 125, 512, 1000, 729, 8, 512, 512, 125, 27, 343, 512, 8, 216, 729, 64, 343, 125, 1000, 1, 216, 64, 512, 216, 1000, 216, 27, 27, 125, 64, 729, 1, 8, 512, 343, 216, 343, 8, },
                               {216, 125, 343, 1, 27, 8, 343, 64, 27, 343, 1, 8, 27, 512, 729, 512, 512, 27, 512, 343, 125, 729, 216, 125, 27, 27, 64, 216, 8, 125, 729, 64, 8, 1, 64, 343, 8, 125, 8, 1, 125, 8, 64, 125, 216, 1, 1, 125, 216, 729, 216, 27, 216, 512, 216, 64, 27, 8, 8, 27, 8, 216, 1, 125, 729, 512, 512, 8, 729, 1, 8, 343, 27, 343, 64, },
                               {8, 216, 8, 729, 343, 64, 27, 8, 27, 125, 729, 1000, 216, 1, 343, 64, 1000, 125, 27, 216, 8, 343, 8, 1, 729, 8, 729, 343, 343, 1000, 512, 8, 8, 64, 125, 8, 1000, 64, 8, 27, 216, 125, 64, 729, 343, 64, 125, 216, 1000, 216, 125, 729, 27, 512, 216, 512, 8, 216, 1000, 343, 64, 343, 512, 216, 1000, 27, 729, 1, 8, 216, 729, 729, 343, 1000, 729, },
                               {125, 27, 1000, 729, 8, 27, 27, 1, 343, 729, 343, 729, 1000, 1000, 729, 512, 343, 729, 64, 64, 1, 8, 64, 343, 125, 27, 512, 8, 216, 216, 729, 1, 8, 64, 1000, 216, 27, 125, 1, 125, 216, 729, 125, 343, 216, 729, 1, 343, 27, 729, 1000, 729, 216, 27, 8, 343, 512, 1000, 1, 1, 343, 64, 64, 216, 125, 512, 125, 512, 27, 1000, 343, 512, 1, 8, 64, },
                               {27, 729, 216, 512, 343, 216, 125, 729, 8, 343, 512, 512, 1000, 343, 1, 343, 64, 125, 125, 27, 64, 1, 27, 1, 64, 343, 216, 729, 1, 64, 27, 8, 729, 27, 343, 343, 8, 729, 64, 8, 1, 1, 125, 8, 8, 512, 125, 1000, 1000, 8, 125, 343, 729, 8, 343, 8, 512, 64, 512, 343, 512, 8, 343, 512, 343, 8, 8, 343, 125, 512, 8, 729, 125, 64, 216, },
                               {8, 729, 343, 343, 125, 27, 125, 1000, 64, 512, 64, 1, 512, 216, 27, 512, 27, 27, 512, 512, 125, 64, 64, 1, 64, 343, 343, 343, 64, 125, 216, 125, 8, 343, 27, 64, 27, 27, 343, 125, 343, 729, 729, 64, 64, 512, 27, 512, 1, 125, 125, 64, 216, 216, 8, 125, 8, 64, 64, 729, 27, 1000, 343, 729, 125, 512, 729, 8, 512, 27, 125, 729, 512, 343, 216, },
                               {64, 729, 1, 8, 64, 1000, 125, 27, 64, 512, 216, 512, 8, 64, 729, 125, 1, 512, 8, 343, 125, 27, 729, 729, 512, 125, 27, 729, 512, 64, 125, 8, 8, 1, 27, 512, 1000, 125, 216, 729, 8, 343, 729, 1000, 1, 216, 729, 343, 729, 64, 216, 64, 343, 64, 1, 64, 64, 729, 64, 125, 729, 64, 216, 64, 64, 64, 729, 1000, 729, 8, 1, 343, 1000, 1, 1000, },
                               {64, 125, 27, 64, 64, 64, 343, 343, 27, 125, 216, 1, 1000, 125, 216, 1000, 125, 216, 512, 125, 729, 27, 8, 27, 343, 64, 8, 729, 216, 512, 125, 125, 512, 343, 216, 343, 512, 216, 343, 8, 512, 512, 27, 729, 1000, 27, 125, 343, 64, 1000, 1, 64, 1, 125, 216, 729, 216, 1, 729, 729, 343, 216, 1, 8, 216, 64, 729, 1, 343, 512, 216, 1, 729, 64, 1000, },
                               {216, 8, 64, 512, 64, 64, 125, 64, 125, 27, 125, 125, 64, 343, 8, 27, 216, 125, 125, 216, 343, 729, 512, 512, 729, 216, 64, 125, 64, 343, 343, 343, 512, 729, 125, 512, 8, 512, 729, 216, 125, 216, 8, 1, 1, 343, 125, 729, 64, 64, 512, 512, 512, 343, 8, 8, 27, 64, 27, 8, 512, 1, 512, 216, 1000, 8, 8, 125, 216, 729, 343, 343, 1, 512, 125, },
                               {1000, 512, 512, 512, 27, 729, 8, 27, 64, 125, 64, 729, 8, 343, 512, 216, 27, 1000, 729, 216, 216, 216, 27, 64, 1000, 1, 27, 8, 216, 27, 64, 512, 343, 27, 27, 1, 729, 64, 343, 8, 27, 64, 125, 64, 64, 512, 1000, 343, 216, 216, 27, 27, 216, 343, 27, 343, 729, 125, 729, 729, 27, 512, 729, 1, 27, 64, 343, 512, 27, 512, 64, 512, 216, 8, 1000, },
                               {1, 64, 27, 64, 343, 27, 125, 27, 27, 27, 125, 27, 8, 729, 64, 1, 8, 343, 27, 8, 729, 512, 512, 1, 125, 64, 64, 343, 1000, 125, 64, 64, 27, 8, 125, 8, 64, 343, 512, 27, 343, 27, 27, 512, 27, 512, 216, 125, 8, 343, 343, 729, 216, 64, 1000, 216, 27, 8, 27, 729, 1000, 125, 1000, 216, 64, 216, 343, 1, 27, 512, 512, 8, 125, 729, 512, },
                               {27, 729, 64, 1000, 27, 729, 729, 125, 216, 512, 1, 8, 125, 1000, 1000, 729, 27, 343, 216, 512, 64, 729, 8, 1000, 8, 343, 216, 216, 729, 343, 343, 1000, 8, 343, 27, 729, 216, 216, 343, 125, 27, 512, 64, 125, 125, 27, 343, 216, 216, 1000, 216, 729, 1, 1, 729, 125, 64, 216, 729, 125, 512, 343, 343, 1, 343, 512, 27, 729, 125, 27, 729, 729, 27, 512, 729, },
                               {125, 125, 216, 729, 64, 64, 125, 1, 1, 125, 512, 27, 216, 343, 125, 125, 343, 64, 8, 343, 216, 64, 8, 1000, 1, 27, 512, 125, 125, 729, 64, 729, 343, 216, 216, 1, 216, 64, 1, 512, 64, 729, 27, 343, 125, 1, 512, 1000, 8, 1000, 216, 343, 512, 125, 729, 512, 512, 125, 64, 8, 1, 343, 216, 64, 27, 8, 343, 125, 343, 125, 64, 1, 216, 27, 27, },
                               {8, 729, 8, 8, 125, 216, 8, 216, 64, 8, 125, 343, 8, 512, 27, 729, 8, 216, 512, 1, 8, 343, 125, 125, 216, 729, 729, 8, 1000, 512, 8, 512, 512, 343, 729, 27, 512, 64, 216, 64, 125, 512, 27, 343, 125, 64, 1, 1, 729, 125, 1000, 1, 64, 8, 8, 64, 64, 343, 27, 1, 216, 64, 8, 512, 729, 1, 27, 729, 64, 125, 729, 64, 512, 64, 27, },
                               {64, 216, 1000, 512, 1, 1000, 64, 512, 1, 729, 1000, 216, 125, 125, 1000, 512, 729, 8, 729, 512, 343, 1000, 125, 216, 512, 64, 125, 343, 512, 343, 125, 8, 64, 729, 729, 125, 216, 27, 8, 27, 8, 8, 343, 1, 8, 8, 729, 343, 343, 729, 512, 1000, 343, 27, 343, 27, 729, 8, 64, 64, 125, 729, 125, 216, 8, 216, 343, 125, 729, 216, 512, 8, 125, 1000, 216, },
                               {125, 1000, 512, 216, 512, 216, 512, 64, 216, 27, 27, 27, 343, 216, 1, 729, 216, 729, 8, 1000, 27, 216, 729, 216, 27, 8, 512, 216, 27, 64, 27, 343, 125, 729, 343, 729, 729, 343, 1000, 729, 125, 1000, 64, 512, 729, 27, 343, 27, 1000, 64, 64, 512, 343, 8, 216, 1, 27, 125, 343, 125, 8, 729, 64, 64, 125, 8, 216, 343, 27, 125, 729, 729, 729, 64, 216, },
                               {216, 125, 125, 216, 1000, 8, 216, 1, 512, 125, 512, 216, 1, 512, 64, 8, 729, 8, 125, 64, 125, 729, 64, 343, 216, 216, 8, 27, 216, 343, 64, 216, 27, 8, 125, 729, 125, 512, 343, 8, 27, 343, 8, 216, 729, 216, 729, 216, 1000, 216, 27, 512, 64, 343, 27, 216, 1000, 27, 125, 27, 729, 343, 27, 216, 512, 512, 216, 64, 1, 216, 8, 27, 512, 512, 64, },
                               {512, 125, 64, 512, 1000, 125, 8, 729, 8, 343, 216, 512, 343, 343, 1000, 216, 216, 27, 343, 216, 8, 729, 27, 1, 64, 512, 343, 216, 1, 216, 27, 343, 125, 512, 125, 64, 1, 125, 512, 27, 64, 729, 1000, 8, 64, 512, 125, 729, 125, 512, 64, 8, 729, 512, 64, 27, 1000, 8, 343, 512, 729, 27, 1, 8, 729, 729, 729, 8, 512, 27, 64, 729, 27, 125, 64, },
                               {64, 512, 1000, 8, 1000, 27, 27, 216, 8, 27, 27, 125, 1, 125, 343, 8, 8, 1, 64, 343, 8, 216, 512, 64, 729, 64, 729, 512, 125, 512, 1, 125, 27, 343, 216, 729, 8, 125, 512, 216, 1, 64, 512, 512, 27, 729, 1000, 27, 27, 64, 8, 216, 729, 729, 343, 8, 1, 64, 343, 64, 64, 8, 729, 216, 729, 343, 343, 512, 27, 8, 1, 125, 216, 27, 729, },
                               {729, 343, 512, 64, 64, 729, 729, 729, 125, 8, 216, 8, 343, 64, 8, 216, 512, 216, 64, 1, 343, 27, 343, 343, 1, 729, 729, 1000, 512, 343, 8, 27, 27, 1, 27, 512, 512, 1, 1000, 27, 729, 512, 1000, 8, 216, 512, 1000, 64, 27, 729, 343, 8, 27, 8, 8, 512, 216, 512, 125, 512, 8, 27, 27, 343, 216, 125, 216, 1000, 27, 729, 8, 729, 125, 343, 27, },
                               {1000, 1000, 64, 343, 27, 216, 216, 343, 216, 216, 125, 64, 64, 343, 512, 64, 125, 729, 1000, 729, 8, 512, 1, 64, 8, 216, 125, 729, 125, 343, 1000, 343, 512, 1000, 27, 343, 125, 343, 343, 512, 512, 216, 729, 729, 27, 512, 1000, 1000, 27, 729, 8, 729, 27, 512, 343, 27, 512, 8, 216, 343, 1000, 27, 512, 64, 1000, 8, 729, 8, 729, 1, 512, 729, 125, 1000, 27, },
                               {343, 64, 64, 27, 512, 729, 216, 1000, 125, 125, 343, 343, 343, 343, 27, 1, 27, 125, 8, 8, 8, 27, 343, 1000, 216, 8, 343, 729, 343, 343, 8, 125, 729, 1000, 125, 27, 1000, 1, 64, 125, 216, 125, 729, 216, 1000, 729, 27, 64, 343, 64, 512, 216, 729, 64, 64, 512, 1000, 343, 729, 27, 1, 64, 125, 729, 64, 729, 216, 216, 64, 64, 343, 27, 125, 1, 343, },
                               {343, 27, 343, 1, 216, 125, 27, 8, 729, 27, 216, 125, 343, 64, 216, 343, 27, 512, 216, 512, 64, 1, 64, 27, 64, 64, 8, 1, 729, 125, 27, 1, 512, 343, 343, 125, 343, 64, 1000, 1, 729, 216, 216, 512, 64, 512, 216, 343, 8, 125, 64, 216, 1000, 1000, 512, 27, 27, 64, 216, 64, 343, 64, 8, 343, 216, 27, 64, 343, 216, 216, 343, 512, 729, 27, 1000, },
                               {8, 8, 64, 64, 512, 512, 64, 8, 729, 512, 64, 64, 216, 343, 125, 343, 125, 8, 343, 64, 125, 64, 216, 8, 512, 216, 8, 512, 125, 343, 8, 729, 216, 512, 729, 125, 216, 125, 729, 64, 64, 343, 216, 125, 27, 216, 1, 27, 729, 64, 1, 729, 125, 729, 729, 512, 729, 1, 1000, 216, 8, 1, 216, 1, 216, 512, 729, 512, 216, 64, 216, 729, 343, 27, 729, },
                               {1000, 125, 27, 27, 512, 64, 8, 27, 64, 216, 27, 343, 27, 729, 343, 27, 125, 1000, 64, 1, 216, 64, 729, 64, 512, 512, 216, 729, 64, 27, 216, 8, 216, 729, 8, 125, 343, 512, 125, 512, 729, 512, 125, 1000, 1000, 512, 8, 8, 125, 64, 729, 512, 729, 64, 8, 64, 512, 729, 343, 729, 64, 27, 125, 512, 27, 125, 64, 216, 27, 125, 27, 729, 216, 125, 125, },
                               {729, 216, 216, 512, 216, 216, 8, 125, 343, 27, 64, 512, 512, 1000, 216, 216, 729, 1000, 64, 729, 27, 216, 216, 8, 729, 64, 343, 64, 729, 216, 1000, 8, 64, 8, 64, 216, 1, 125, 729, 512, 27, 343, 729, 729, 729, 343, 8, 729, 8, 1000, 8, 1, 729, 1, 27, 512, 27, 1, 27, 125, 512, 729, 125, 8, 27, 216, 125, 8, 125, 216, 125, 8, 125, 27, 64, },
                               {512, 27, 343, 343, 512, 27, 27, 216, 125, 1, 64, 27, 512, 216, 1, 343, 343, 64, 216, 27, 125, 1, 729, 729, 8, 125, 27, 64, 64, 27, 216, 216, 64, 8, 1, 8, 64, 343, 216, 216, 343, 343, 8, 216, 27, 729, 343, 8, 8, 512, 729, 729, 343, 216, 343, 125, 64, 125, 27, 512, 216, 729, 512, 343, 512, 125, 8, 512, 8, 729, 216, 64, 27, 729, 216, },
                               {512, 125, 729, 729, 27, 27, 64, 216, 27, 8, 64, 27, 125, 27, 512, 64, 8, 1000, 8, 1000, 216, 216, 729, 729, 216, 8, 27, 125, 125, 64, 64, 27, 216, 216, 125, 216, 125, 1, 125, 64, 27, 1000, 125, 729, 343, 27, 512, 1, 8, 729, 125, 343, 1000, 729, 512, 512, 729, 1, 125, 125, 512, 27, 343, 729, 343, 64, 729, 216, 512, 729, 125, 125, 27, 216, 1000, },
                               {1, 27, 1, 27, 1, 27, 125, 27, 512, 216, 64, 8, 125, 64, 125, 343, 729, 64, 27, 125, 64, 512, 343, 512, 729, 343, 729, 125, 512, 343, 216, 216, 64, 512, 343, 729, 27, 1, 512, 125, 512, 512, 8, 512, 729, 1000, 27, 512, 27, 8, 729, 1, 512, 512, 27, 125, 8, 125, 8, 729, 1, 27, 512, 1000, 216, 216, 216, 512, 27, 1000, 343, 64, 216, 1, 64, }};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestTransposeSmall) {
    Vec2d<TypeParam> a {{4, 9}, {3, 4}, {5, 6}};

    auto result = transpose(a);

    Vec2d<TypeParam> expected {{4, 3, 5}, {9, 4, 6}};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestTransposeMed) {
    Vec2d<TypeParam> a {{4,8,7,4,10,8,5,5,1,1,6,6,2,1,7},
                        {10,2,4,3,9,8,8,4,4,8,4,0,10,7,4},
                        {7,8,6,6,4,9,7,10,6,6,9,4,4,1,0},
                        {5,5,10,2,9,4,3,8,10,5,4,2,7,1,2},
                        {8,10,5,1,5,7,4,3,2,0,1,2,10,1,9},
                        {1,2,2,2,6,8,4,9,2,7,6,8,6,1,3},
                        {7,3,6,6,9,6,5,8,9,4,5,1,9,7,2},
                        {8,8,7,7,4,7,8,7,10,0,6,8,3,1,1},
                        {2,6,1,1,8,0,2,0,3,2,1,9,8,3,5},
                        {6,0,4,2,4,1,1,7,5,8,1,4,8,8,4}};

    auto result = transpose(a);

    Vec2d<TypeParam> expected {{4, 10, 7, 5, 8, 1, 7, 8, 2, 6, },
                               {8, 2, 8, 5, 10, 2, 3, 8, 6, 0, },
                               {7, 4, 6, 10, 5, 2, 6, 7, 1, 4, },
                               {4, 3, 6, 2, 1, 2, 6, 7, 1, 2, },
                               {10, 9, 4, 9, 5, 6, 9, 4, 8, 4, },
                               {8, 8, 9, 4, 7, 8, 6, 7, 0, 1, },
                               {5, 8, 7, 3, 4, 4, 5, 8, 2, 1, },
                               {5, 4, 10, 8, 3, 9, 8, 7, 0, 7, },
                               {1, 4, 6, 10, 2, 2, 9, 10, 3, 5, },
                               {1, 8, 6, 5, 0, 7, 4, 0, 2, 8, },
                               {6, 4, 9, 4, 1, 6, 5, 6, 1, 1, },
                               {6, 0, 4, 2, 2, 8, 1, 8, 9, 4, },
                               {2, 10, 4, 7, 10, 6, 9, 3, 8, 8, },
                               {1, 7, 1, 1, 1, 1, 7, 1, 3, 8, },
                               {7, 4, 0, 2, 9, 3, 2, 1, 5, 4, }};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestTransposeBig) {
    Vec2d<TypeParam> a {{6,8,3,8,4,7,5,7,2,8,1,9,8,10,10,4,1,5,10,1},
                        {8,9,0,8,3,6,1,8,7,3,9,5,5,6,6,6,3,10,7,4},
                        {0,1,9,8,9,1,3,6,9,3,6,1,8,7,2,1,7,4,9,8},
                        {2,6,3,1,7,10,9,7,8,6,5,8,0,2,7,3,0,0,9,4},
                        {6,4,1,5,7,2,2,8,1,5,10,7,2,3,9,0,9,10,8,4},
                        {9,3,2,1,4,10,1,2,6,5,6,8,6,7,9,6,7,1,3,4},
                        {8,5,3,6,6,1,10,3,2,3,10,4,9,5,2,8,2,7,9,3},
                        {6,6,6,9,1,8,5,3,9,7,4,5,7,6,4,6,5,4,2,5},
                        {2,3,3,9,7,1,3,1,5,10,7,1,2,7,5,6,1,6,7,2},
                        {4,3,10,3,3,6,9,1,3,9,7,7,2,8,10,2,6,8,5,3},
                        {3,2,4,2,5,2,8,1,6,2,9,1,8,9,6,4,3,4,9,4},
                        {2,6,2,4,4,0,8,5,6,2,8,7,5,6,2,8,1,7,2,10},
                        {9,7,1,7,4,7,9,5,9,8,7,5,5,7,9,8,6,3,2,1},
                        {6,5,2,2,9,8,4,7,1,9,7,4,6,8,2,5,7,5,7,1},
                        {1,1,7,5,3,2,3,4,9,10,1,7,3,7,9,3,7,2,9,5},
                        {3,9,4,6,5,0,1,10,6,5,5,7,1,3,5,10,10,0,9,9},
                        {7,9,6,9,7,3,2,8,9,4,4,9,8,9,4,1,8,6,0,6},
                        {7,8,0,5,6,8,1,2,9,6,7,3,1,5,1,5,4,2,9,2},
                        {4,4,6,5,2,7,8,10,4,10,9,2,4,4,4,3,2,10,6,4},
                        {10,3,9,9,8,4,0,4,9,4,9,4,4,4,5,8,7,9,6,2},
                        {7,5,7,0,3,1,7,2,3,0,2,7,1,8,9,1,5,1,5,6},
                        {6,10,1,4,0,2,6,9,7,7,2,8,1,6,1,5,0,3,7,4},
                        {1,4,1,2,8,4,1,2,4,8,6,6,1,0,8,8,7,1,9,9},
                        {1,1,5,7,8,9,7,2,6,0,8,1,4,2,3,3,2,2,2,4},
                        {1,0,8,1,7,6,3,8,0,5,1,1,6,6,0,4,8,8,3,5},
                        {10,9,6,7,4,5,8,9,0,7,3,7,6,5,7,0,7,3,9,7},
                        {3,9,3,3,8,6,0,0,2,2,7,2,6,9,3,3,7,8,4,1},
                        {5,8,8,9,1,4,10,10,5,9,0,7,8,2,3,8,2,4,6,5},
                        {3,2,6,2,6,6,9,7,5,2,8,4,9,7,1,0,2,10,7,10},
                        {5,10,0,3,9,1,8,9,8,3,4,0,0,6,1,2,5,6,8,0},
                        {9,8,6,5,8,8,7,8,6,1,4,10,2,2,4,1,3,1,7,3},
                        {3,8,1,9,3,2,10,3,5,0,9,6,8,6,4,0,1,7,2,8},
                        {2,3,6,8,9,4,10,5,0,7,3,5,0,0,4,5,8,4,10,2},
                        {4,6,0,7,8,7,0,2,2,7,4,9,7,8,0,9,7,7,9,8},
                        {1,2,7,10,6,2,1,2,1,9,7,2,2,1,2,5,2,8,2,10},
                        {6,8,1,5,4,10,6,5,9,7,4,2,6,2,6,8,1,1,2,2},
                        {6,5,5,10,4,4,0,2,7,1,5,4,5,7,8,3,6,5,8,4},
                        {9,2,5,1,8,4,1,6,3,5,0,5,6,5,8,6,9,4,7,5},
                        {1,7,3,5,9,9,6,3,5,5,4,5,0,4,8,2,5,7,3,5},
                        {6,4,2,8,4,2,5,4,10,4,3,3,9,6,1,7,2,3,6,3},
                        {1,2,2,2,5,7,4,1,1,8,9,1,4,7,6,6,7,2,5,2},
                        {1,4,9,1,1,1,6,6,8,4,1,2,5,2,9,1,7,8,1,5},
                        {9,10,8,4,4,3,7,3,1,4,9,10,8,0,2,3,3,2,2,9},
                        {4,4,6,6,5,7,10,4,3,1,8,8,1,7,10,1,4,2,5,4},
                        {7,1,9,10,9,10,3,6,7,0,8,1,0,4,1,7,2,2,8,3},
                        {8,1,0,5,2,4,9,6,10,7,6,4,4,1,4,3,2,1,3,1},
                        {8,10,5,4,5,7,0,9,2,0,0,3,2,2,6,9,2,6,4,4},
                        {9,3,7,2,4,7,4,5,7,5,6,7,6,8,3,2,4,9,7,2},
                        {6,5,9,3,8,2,10,7,5,3,3,0,9,4,8,1,6,8,9,7},
                        {7,1,7,8,0,5,6,4,6,8,8,3,10,3,8,7,2,6,0,8}};

    auto result = transpose(a);

    Vec2d<TypeParam> expected {{6, 8, 0, 2, 6, 9, 8, 6, 2, 4, 3, 2, 9, 6, 1, 3, 7, 7, 4, 10, 7, 6, 1, 1, 1, 10, 3, 5, 3, 5, 9, 3, 2, 4, 1, 6, 6, 9, 1, 6, 1, 1, 9, 4, 7, 8, 8, 9, 6, 7, },
                               {8, 9, 1, 6, 4, 3, 5, 6, 3, 3, 2, 6, 7, 5, 1, 9, 9, 8, 4, 3, 5, 10, 4, 1, 0, 9, 9, 8, 2, 10, 8, 8, 3, 6, 2, 8, 5, 2, 7, 4, 2, 4, 10, 4, 1, 1, 10, 3, 5, 1, },
                               {3, 0, 9, 3, 1, 2, 3, 6, 3, 10, 4, 2, 1, 2, 7, 4, 6, 0, 6, 9, 7, 1, 1, 5, 8, 6, 3, 8, 6, 0, 6, 1, 6, 0, 7, 1, 5, 5, 3, 2, 2, 9, 8, 6, 9, 0, 5, 7, 9, 7, },
                               {8, 8, 8, 1, 5, 1, 6, 9, 9, 3, 2, 4, 7, 2, 5, 6, 9, 5, 5, 9, 0, 4, 2, 7, 1, 7, 3, 9, 2, 3, 5, 9, 8, 7, 10, 5, 10, 1, 5, 8, 2, 1, 4, 6, 10, 5, 4, 2, 3, 8, },
                               {4, 3, 9, 7, 7, 4, 6, 1, 7, 3, 5, 4, 4, 9, 3, 5, 7, 6, 2, 8, 3, 0, 8, 8, 7, 4, 8, 1, 6, 9, 8, 3, 9, 8, 6, 4, 4, 8, 9, 4, 5, 1, 4, 5, 9, 2, 5, 4, 8, 0, },
                               {7, 6, 1, 10, 2, 10, 1, 8, 1, 6, 2, 0, 7, 8, 2, 0, 3, 8, 7, 4, 1, 2, 4, 9, 6, 5, 6, 4, 6, 1, 8, 2, 4, 7, 2, 10, 4, 4, 9, 2, 7, 1, 3, 7, 10, 4, 7, 7, 2, 5, },
                               {5, 1, 3, 9, 2, 1, 10, 5, 3, 9, 8, 8, 9, 4, 3, 1, 2, 1, 8, 0, 7, 6, 1, 7, 3, 8, 0, 10, 9, 8, 7, 10, 10, 0, 1, 6, 0, 1, 6, 5, 4, 6, 7, 10, 3, 9, 0, 4, 10, 6, },
                               {7, 8, 6, 7, 8, 2, 3, 3, 1, 1, 1, 5, 5, 7, 4, 10, 8, 2, 10, 4, 2, 9, 2, 2, 8, 9, 0, 10, 7, 9, 8, 3, 5, 2, 2, 5, 2, 6, 3, 4, 1, 6, 3, 4, 6, 6, 9, 5, 7, 4, },
                               {2, 7, 9, 8, 1, 6, 2, 9, 5, 3, 6, 6, 9, 1, 9, 6, 9, 9, 4, 9, 3, 7, 4, 6, 0, 0, 2, 5, 5, 8, 6, 5, 0, 2, 1, 9, 7, 3, 5, 10, 1, 8, 1, 3, 7, 10, 2, 7, 5, 6, },
                               {8, 3, 3, 6, 5, 5, 3, 7, 10, 9, 2, 2, 8, 9, 10, 5, 4, 6, 10, 4, 0, 7, 8, 0, 5, 7, 2, 9, 2, 3, 1, 0, 7, 7, 9, 7, 1, 5, 5, 4, 8, 4, 4, 1, 0, 7, 0, 5, 3, 8, },
                               {1, 9, 6, 5, 10, 6, 10, 4, 7, 7, 9, 8, 7, 7, 1, 5, 4, 7, 9, 9, 2, 2, 6, 8, 1, 3, 7, 0, 8, 4, 4, 9, 3, 4, 7, 4, 5, 0, 4, 3, 9, 1, 9, 8, 8, 6, 0, 6, 3, 8, },
                               {9, 5, 1, 8, 7, 8, 4, 5, 1, 7, 1, 7, 5, 4, 7, 7, 9, 3, 2, 4, 7, 8, 6, 1, 1, 7, 2, 7, 4, 0, 10, 6, 5, 9, 2, 2, 4, 5, 5, 3, 1, 2, 10, 8, 1, 4, 3, 7, 0, 3, },
                               {8, 5, 8, 0, 2, 6, 9, 7, 2, 2, 8, 5, 5, 6, 3, 1, 8, 1, 4, 4, 1, 1, 1, 4, 6, 6, 6, 8, 9, 0, 2, 8, 0, 7, 2, 6, 5, 6, 0, 9, 4, 5, 8, 1, 0, 4, 2, 6, 9, 10, },
                               {10, 6, 7, 2, 3, 7, 5, 6, 7, 8, 9, 6, 7, 8, 7, 3, 9, 5, 4, 4, 8, 6, 0, 2, 6, 5, 9, 2, 7, 6, 2, 6, 0, 8, 1, 2, 7, 5, 4, 6, 7, 2, 0, 7, 4, 1, 2, 8, 4, 3, },
                               {10, 6, 2, 7, 9, 9, 2, 4, 5, 10, 6, 2, 9, 2, 9, 5, 4, 1, 4, 5, 9, 1, 8, 3, 0, 7, 3, 3, 1, 1, 4, 4, 4, 0, 2, 6, 8, 8, 8, 1, 6, 9, 2, 10, 1, 4, 6, 3, 8, 8, },
                               {4, 6, 1, 3, 0, 6, 8, 6, 6, 2, 4, 8, 8, 5, 3, 10, 1, 5, 3, 8, 1, 5, 8, 3, 4, 0, 3, 8, 0, 2, 1, 0, 5, 9, 5, 8, 3, 6, 2, 7, 6, 1, 3, 1, 7, 3, 9, 2, 1, 7, },
                               {1, 3, 7, 0, 9, 7, 2, 5, 1, 6, 3, 1, 6, 7, 7, 10, 8, 4, 2, 7, 5, 0, 7, 2, 8, 7, 7, 2, 2, 5, 3, 1, 8, 7, 2, 1, 6, 9, 5, 2, 7, 7, 3, 4, 2, 2, 2, 4, 6, 2, },
                               {5, 10, 4, 0, 10, 1, 7, 4, 6, 8, 4, 7, 3, 5, 2, 0, 6, 2, 10, 9, 1, 3, 1, 2, 8, 3, 8, 4, 10, 6, 1, 7, 4, 7, 8, 1, 5, 4, 7, 3, 2, 8, 2, 2, 2, 1, 6, 9, 8, 6, },
                               {10, 7, 9, 9, 8, 3, 9, 2, 7, 5, 9, 2, 2, 7, 9, 9, 0, 9, 6, 6, 5, 7, 9, 2, 3, 9, 4, 6, 7, 8, 7, 2, 10, 9, 2, 2, 8, 7, 3, 6, 5, 1, 2, 5, 8, 3, 4, 7, 9, 0, },
                               {1, 4, 8, 4, 4, 4, 3, 5, 2, 3, 4, 10, 1, 1, 5, 9, 6, 2, 4, 2, 6, 4, 9, 4, 5, 7, 1, 5, 10, 0, 3, 8, 2, 8, 10, 2, 4, 5, 5, 3, 2, 5, 9, 4, 3, 1, 4, 2, 7, 8,}};

    VEC2D_EXPECT_EQ(result, expected)
}

TYPED_TEST(UtilsTest, UtilsTestMeanSmall) {
    Vec2d<TypeParam> a {{4, 9}, {3, 4}};

    auto result = mean(a);

    TypeParam expected = 5;

    EXPECT_EQ(result, expected);
}

TYPED_TEST(UtilsTest, UtilsTestMeanMed) {
    Vec2d<TypeParam> a {{69,68,9,23,16,29,51,58,12,17},
                        {97,55,84,48,84,91,30,19,85,87},
                        {84,67,94,68,38,4,49,48,38,90},
                        {65,81,42,8,46,71,2,77,45,72},
                        {39,7,95,80,15,65,69,85,2,31},
                        {28,23,36,62,80,98,14,19,18,88},
                        {91,97,95,34,33,98,81,99,98,45},
                        {82,21,69,50,40,50,0,36,47,34},
                        {9,55,84,12,29,15,23,58,80,43},
                        {26,94,92,31,87,62,40,48,84,57}};

    auto result = mean(a);

    TypeParam expected = 53.04;

    EXPECT_FLOAT_EQ(result, expected);
}

TYPED_TEST(UtilsTest, UtilsTestMeanBig) {
    Vec2d<TypeParam> a {{170,877,697,458,253,305,745,191,792,6,795,812,12,926,39,850,299,79,741,434,644,699,605,866,467,904,275,673,153,399,746,740,668,940,608,707,822,792,301,783,704,333,527,592,772,169,514,132,991,680},
                        {924,828,50,488,312,842,80,368,892,613,532,871,729,798,319,151,898,78,238,681,749,192,464,82,655,354,992,111,11,397,819,68,551,486,167,702,653,650,880,85,134,360,516,494,103,907,792,93,770,190},
                        {307,175,63,772,464,901,904,603,645,637,683,873,784,882,266,135,987,893,531,249,69,424,63,519,611,989,0,941,77,498,832,220,413,379,685,130,938,131,117,226,897,656,608,193,646,142,467,976,112,436},
                        {58,616,838,669,452,108,254,778,243,829,741,178,195,816,276,824,989,728,219,253,574,362,752,491,889,643,35,11,597,43,276,961,466,336,23,560,405,518,474,196,894,666,626,26,402,153,272,380,250,431},
                        {230,669,768,311,212,34,432,73,755,552,271,253,676,862,37,430,985,306,334,252,607,453,915,945,713,391,469,947,161,48,898,472,647,793,941,2,644,165,744,913,572,432,345,29,707,756,743,742,277,977},
                        {13,282,74,199,419,671,280,512,722,445,151,428,316,140,813,584,816,25,442,147,990,484,550,160,31,703,4,263,69,53,569,614,745,607,537,574,255,50,23,390,226,922,706,344,74,905,571,810,161,157},
                        {96,313,80,451,180,230,618,187,93,954,318,763,89,155,709,54,896,338,827,841,599,500,53,41,348,810,683,630,966,405,0,922,44,19,893,320,216,755,337,48,180,377,923,523,713,805,984,966,998,892},
                        {956,299,537,164,951,592,52,426,42,696,708,51,984,991,814,3,118,197,647,673,392,14,267,956,645,978,980,483,676,272,99,281,875,96,5,186,478,17,841,918,993,766,989,774,626,974,260,837,282,651},
                        {774,515,154,405,557,101,467,87,284,602,597,245,799,667,971,627,997,82,631,823,206,955,728,169,332,217,730,358,443,752,127,234,647,588,780,753,934,454,778,193,356,61,549,125,256,828,14,840,111,651},
                        {560,787,245,70,269,149,433,526,727,676,123,183,151,528,398,658,69,501,724,694,754,623,51,521,156,398,723,534,199,146,376,767,947,422,936,782,145,622,35,762,680,759,391,723,729,742,545,705,807,810},
                        {659,59,177,637,946,527,630,173,58,19,10,927,368,390,6,745,557,397,579,875,687,527,984,204,551,304,50,718,441,787,607,563,256,697,306,900,587,966,872,741,117,942,248,736,938,515,800,229,412,842},
                        {549,539,926,650,513,204,485,595,469,668,922,767,96,597,561,310,425,554,465,195,456,427,354,935,316,816,332,300,541,614,241,277,429,531,266,716,732,206,854,620,335,839,680,75,652,725,642,689,416,356},
                        {151,989,958,605,157,591,238,890,947,189,986,221,954,413,140,249,691,38,334,162,369,405,896,605,505,119,927,243,127,795,301,303,568,454,825,336,645,184,718,195,943,885,177,426,126,753,664,987,488,266},
                        {802,366,831,919,979,249,79,130,948,29,78,333,271,462,976,199,306,376,435,312,659,240,469,413,290,581,938,46,405,145,916,632,24,755,231,438,511,871,106,785,261,329,570,36,406,840,537,638,113,450},
                        {795,210,804,283,891,294,299,387,17,835,855,647,634,25,134,532,110,84,397,874,131,870,202,479,903,70,672,362,440,356,436,782,426,260,574,585,894,776,917,587,321,734,590,482,410,252,161,537,558,336},
                        {736,515,854,506,501,125,311,384,69,624,207,883,306,280,801,302,23,512,229,872,893,869,323,9,302,200,268,470,38,764,684,99,710,35,166,138,712,386,825,996,92,920,161,887,92,465,27,175,684,182},
                        {798,71,983,160,354,49,296,821,629,622,103,94,216,112,490,823,289,627,756,437,127,409,472,800,677,211,6,489,210,847,233,529,479,202,724,540,500,580,609,175,816,558,960,883,970,376,330,811,8,673},
                        {108,75,972,448,773,306,304,440,361,460,139,400,760,950,402,670,153,658,726,78,382,618,695,448,670,992,673,70,52,76,144,174,991,257,729,412,127,755,952,434,462,238,874,48,447,776,281,181,811,458},
                        {891,524,420,799,92,933,70,626,214,276,362,217,101,182,957,738,32,495,513,79,186,867,759,638,582,942,589,292,707,22,693,128,396,681,358,886,203,646,114,802,231,183,807,231,337,67,223,153,857,399},
                        {869,379,49,323,40,837,105,316,717,255,655,133,491,436,374,711,245,337,927,680,61,994,215,747,686,464,469,422,686,276,41,468,560,450,870,286,725,975,444,391,789,447,835,528,884,805,533,544,757,510}};

    auto result = mean(a);

    TypeParam expected = 487.504;

    EXPECT_FLOAT_EQ(result, expected);
}

















































































